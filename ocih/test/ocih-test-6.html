<!DOCTYPE html>
<html lang="en" style="direction:ltr;">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<title>6-test â€¢ Interactive Exam</title>
<meta name="color-scheme" content="dark" />
<!-- File name rule: (name of pdf)-test -->
<style>
  :root{
    --bg:#0b0b12;
    --text:#f6f7fb;
    --muted:#a6afc6;
    --card:rgba(255,255,255,0.05);
    --card-border:rgba(255,255,255,0.12);
    --glass:rgba(255,255,255,0.04);
    --glass-border:rgba(255,255,255,0.10);
    --glow-cyan:#06b6d4;
    --glow-cyan-outer:rgba(6,182,212,0.40);
    --glow-purple:#8b5cf6;
    --glow-purple-outer:rgba(139,92,246,0.35);
    --white-haze:rgba(255,255,255,0.08);
    --white-outer:rgba(255,255,255,0.15);
    --radius:16px;
    --gap:1.25rem;
    --pad:1.5rem;
    --ok:#22c55e;  /* green */
    --bad:#ef4444; /* red */
  }

  *{box-sizing:border-box}
  body{margin:0;font:16px/1.65 Inter,ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto;color:var(--text);background:var(--bg);min-height:100dvh;}
  .wrap{max-width:1100px;margin:0 auto;padding:24px;}

  .titlebar{
    position: static;z-index:10;
    backdrop-filter:saturate(140%) blur(8px);
    background:linear-gradient(180deg,rgba(11,11,18,0.75),rgba(11,11,18,0.35));
    border-bottom:1px solid var(--glass-border);
  }
  .titlebar .inner{max-width:1100px;margin:0 auto;padding:16px 24px;display:grid;gap:8px;align-items:center;}
  .grad-text{
    font-weight:800;
    letter-spacing:.3px;
    background:linear-gradient(90deg,var(--glow-cyan),var(--glow-purple));
    -webkit-background-clip:text;background-clip:text;color:transparent;
    text-shadow:0 0 10px var(--glow-cyan-outer), 0 0 14px var(--glow-purple-outer);
  }
  h1.grad-text{font-size:clamp(1.6rem,2vw+1rem,2.6rem);margin:0;text-align:center;}
  .subtitle{margin:0;text-align:center;color:var(--muted);font-size:0.95rem}

  .section-h{
    margin:28px 0 14px;
    padding:12px 16px;
    border-radius:var(--radius);
    background:var(--glass);
    border:1px solid var(--glass-border);
    box-shadow: 0 2px 10px var(--white-haze), 0 0 18px rgba(255,255,255,0.06), 0 0 30px var(--white-outer);
    text-align:center;
    font-weight:750;
    font-size:1.15rem;
  }
  .section-h .grad-text{font-size:1.3rem;}

  .grid{display:grid;gap:var(--gap)}
  @media (min-width:800px){
    .grid.mcq{grid-template-columns:repeat(2,minmax(0,1fr));}
    .grid.tf {grid-template-columns:repeat(3,minmax(0,1fr));}
  }

  /* Cards (no accent on the card itself) */
  .card{
    background:var(--card);
    border:1px solid var(--card-border);
    border-radius:var(--radius);
    padding:var(--pad);
    box-shadow: 0 2px 8px var(--white-haze), 0 0 0 1px rgba(255,255,255,0.02), 0 0 24px rgba(255,255,255,0.06);
    position:relative;
  }

  .qtitle{font-weight:650;margin:0 0 12px}
  .meta{color:var(--muted);font-size:0.88rem;margin-bottom:10px}

  .opts{display:grid;gap:10px}
  .opt-btn{
    all:unset;cursor:pointer;display:flex;gap:10px;align-items:center;
    padding:12px 14px;border-radius:12px;
    background:rgba(255,255,255,0.03);
    border:1px solid rgba(255,255,255,0.10);
    transition:transform .06s ease, background .15s ease, border-color .15s ease;
  }
  .opt-btn .key{width:28px;height:28px;border-radius:9px;display:grid;place-items:center;font-weight:700;
    background:linear-gradient(90deg,var(--glow-cyan),var(--glow-purple));color:#0b0b12;
    box-shadow:0 0 10px var(--glow-cyan-outer),0 0 10px var(--glow-purple-outer) inset;
  }
  .opt-btn:hover{transform:translateY(-1px);border-color:rgba(255,255,255,0.22);}

  /* Accent line ONLY on the chosen/correct answer box, no background highlight */
  .opt-btn.correct{
    border-left:6px solid var(--ok);
    outline:none;
    background:rgba(255,255,255,0.03);
  }
  .opt-btn.wrong{
    border-left:6px solid var(--bad);
    outline:none;
    background:rgba(255,255,255,0.03);
  }
  .opt-btn[disabled]{opacity:.85;cursor:not-allowed;pointer-events:none;}

  .feedback{margin-top:10px;border-radius:12px;padding:10px 12px;border:1px dashed rgba(255,255,255,0.18);background:rgba(255,255,255,0.03);color:var(--muted);}
  .feedback[hidden]{display:none;}
  .feedback b{color:var(--text)}

  .answer{margin-top:10px;padding:12px;border-radius:12px;border:1px solid rgba(255,255,255,0.14);background:rgba(255,255,255,0.04)}
  .answer[hidden]{display:none;}
  .btnrow{display:flex;gap:10px;flex-wrap:wrap}
  .ghost, .primary{
    all:unset;cursor:pointer;border-radius:12px;padding:10px 14px;font-weight:650;border:1px solid rgba(255,255,255,0.18);
    background:rgba(255,255,255,0.03);
  }
  .primary{background:linear-gradient(90deg,var(--glow-cyan),var(--glow-purple));color:#0b0b12;border-color:transparent;}

  .score{
    margin:16px 0;padding:12px 14px;border-radius:14px;
    background:var(--glass);border:1px solid var(--glass-border);box-shadow: 0 2px 10px var(--white-haze), 0 0 18px rgba(255,255,255,0.06), 0 0 30px var(--white-outer);
    display:flex;justify-content:space-between;align-items:center;gap:10px;flex-wrap:wrap;
  }
  .score .part{color:var(--muted);font-weight:600}
  .score b{color:var(--text)}
</style>
</head>
<body>
  <header class="titlebar">
    <div class="inner">
      <h1 class="grad-text">ğŸ¦· Dentistry 3rd year</h1>
      <p class="subtitle">Test based on Lecture 6</p>
    </div>
  </header>

  <main class="wrap">

    <h2 class="section-h"><span class="grad-text">Ø§Ù„Ù„Ù‘ÙÙ‡ÙÙ…Ù‘Ù Ù„Ø§ Ø³ÙÙ‡Ù’Ù„Ù Ø¥ÙÙ„Ù‘ÙØ§ Ù…ÙØ§ Ø¬ÙØ¹ÙÙ„Ù’ØªÙÙ‡Ù Ø³ÙÙ‡Ù’Ù„Ù‹Ø§ØŒ ÙˆÙØ£ÙÙ†Ù’ØªÙ ØªÙØ¬Ù’Ø¹ÙÙ„Ù Ø§Ù„Ø­ÙØ²Ù’Ù†Ù Ø¥ÙØ°ÙØ§ Ø´ÙØ¦Ù’ØªÙ Ø³ÙÙ‡Ù’Ù„Ù‹Ø§</span></h2>

    <section class="score" id="scoreTop">
      <div class="part">MCQs: <b><span id="sMcq">0</span>/30</b></div>
      <div class="part">True/False: <b><span id="sTf">0</span>/12</b></div>
      <div class="part">SAQs: <b><span id="sSaq">0</span>/3</b></div>
      <div class="part">Total: <b><span id="sTotal">0</span>/45</b></div>
      <div class="btnrow">
        <button class="ghost" id="resetAll">Reset</button>
      </div>
    </section>

    <h2 class="section-h"><span class="grad-text">MCQs</span></h2>
    <div class="grid mcq" id="mcqGrid"></div>

    <h2 class="section-h"><span class="grad-text">True / False</span></h2>
    <div class="grid tf" id="tfGrid"></div>

    <h2 class="section-h"><span class="grad-text">Short Answer Questions</span></h2>
    <div class="grid" id="saqGrid"></div>

    <section class="score" id="scoreBottom">
      <div class="part">MCQs: <b><span id="sMcq2">0</span>/30</b></div>
      <div class="part">True/False: <b><span id="sTf2">0</span>/12</b></div>
      <div class="part">SAQs: <b><span id="sSaq2">0</span>/3</b></div>
      <div class="part">Total: <b><span id="sTotal2">0</span>/45</b></div>
    </section>
  </main>

<script>
// ----------- Data (lecture-based) -----------
const mcqs = [
  {q:"Which epithelium lines the primitive oral cavity (stomodeum)?",opts:["Oral ectoderm (stratified squamous)","Endoderm","Simple columnar epithelium","Respiratory pseudostratified"],correct:0,explain:"The stomodeum is lined by oral ectoderm (stratified squamous)."},
  {q:"The buccopharyngeal membrane normally ruptures at approximately:",opts:["4th week (â‰ˆ27th day)","2nd week","8th week","Birth"],correct:0,explain:"Rupture occurs around the 4th week (day 27) allowing connection between the stomodeum and foregut."},
  {q:"At 5â€“6 weeks in utero, the oral ectoderm typically consists of:",opts:["2â€“3 layers: basal columnar + superficial flat","Keratinized stratified squamous (5â€“7 layers)","Single cuboidal layer","Pseudostratified with cilia"],correct:0,explain:"Slides note 2â€“3 layers: basal columnar and superficial flat cells."},
  {q:"The oral ectoderm is separated from underlying mesenchyme by:",opts:["A basement membrane","Desmosomes","Lamina dura","Sharpeyâ€™s fibers"],correct:0,explain:"A basement membrane separates ectoderm from ectomesenchyme."},
  {q:"Primary epithelial bands form under the influence of:",opts:["Neural crestâ€“derived ectomesenchyme","Endodermal mesenchyme","Myoblast migration","Cartilage precursors"],correct:0,explain:"Ectomesenchyme (neural crest) induces ectodermal proliferation â†’ primary epithelial band."},
  {q:"The primary epithelial band gives rise to:",opts:["Dental lamina and vestibular lamina","Enamel organ and dental papilla","Reduced enamel epithelium only","Hertwigâ€™s root sheath"],correct:0,explain:"Two horseshoe bands differentiate into dental lamina and vestibular lamina."},
  {q:"Function of the vestibular lamina:",opts:["Forms the oral vestibule via epithelial breakdown","Forms enamel","Forms dentin","Forms periodontal ligament"],correct:0,explain:"Degeneration/clefting within vestibular lamina creates the vestibular groove."},
  {q:"Morphological stages of tooth development include all EXCEPT:",opts:["Apposition","Bud","Cap","Bell"],correct:0,explain:"Apposition is a histophysiological stage; morphological stages are dental lamina, bud, cap, bell."},
  {q:"Which is a histophysiological stage?",opts:["Histodifferentiation","Bud","Cap","Bell"],correct:0,explain:"Histodifferentiation is a physiologic stage of tissue specialization."},
  {q:"Sequence of histophysiological stages:",opts:["Initiation â†’ Proliferation â†’ Histodifferentiation â†’ Morphodifferentiation â†’ Apposition","Bud â†’ Cap â†’ Bell â†’ Root formation","Apposition â†’ Initiation â†’ Proliferation â†’ Maturation","Histodifferentiation â†’ Initiation â†’ Morphodifferentiation â†’ Apposition"],correct:0,explain:"This is the classic order presented in the slides."},
  {q:"Number of tooth buds that initially appear on the dental lamina for the primary dentition:",opts:["20","10","32","28"],correct:0,explain:"Twenty tooth buds appear corresponding to the primary teeth."},
  {q:"The connection between the enamel organ and dental lamina breaks down starting at:",opts:["Anterior teeth (then spreads posteriorly)","Third molar region first","All at once","Only mandibular teeth"],correct:0,explain:"Breakdown begins in anterior regions and spreads posteriorly."},
  {q:"After separation at bell stage, the primary tooth lamina adjacent to the enamel organ is called:",opts:["Lateral lamina","Reduced enamel epithelium","Hertwigâ€™s lamina","Successional sheet"],correct:0,explain:"It is termed the lateral dental lamina."},
  {q:"Successional lamina forms which permanent teeth?",opts:["Incisors, canines, premolars","Molars only","Only incisors","Only canines"],correct:0,explain:"Successional lamina gives permanent successors of primary teeth (I, C, P)."},
  {q:"Permanent molars arise from:",opts:["Distal extension of the main dental lamina","Successional lamina","Vestibular lamina","Lateral lamina"],correct:0,explain:"Molars are nonâ€‘successional; they develop from a distal extension of dental lamina."},
  {q:"Relative rate of development: permanent vs primary teeth:",opts:["Permanent teeth develop slower","Permanent faster","Same rate","Indeterminate"],correct:0,explain:"Slides: permanent teeth develop slower than primary teeth."},
  {q:"Fate of dental lamina after tooth development progresses:",opts:["Degenerates leaving epithelial rests (of Serres)","Becomes periodontal ligament","Forms cementum","Transforms into junctional epithelium"],correct:0,explain:"Islands remain as cell rests of Serres within jaws/gingiva."},
  {q:"In the third molar region, remnants of dental lamina can persist until approximately:",opts:["5 years","Birth","1 year","10 days"],correct:0,explain:"Slides mention ~5 years in 3rd molar region."},
  {q:"Epithelialâ€“mesenchymal interaction in odontogenesis is best described as:",opts:["Programmed, sequential, reciprocal signaling","Random contact inhibition","Purely mechanical pressure","Endocrine only"],correct:0,explain:"Defined as programmed, sequential, reciprocal communications leading to differentiation."},
  {q:"Earliest morphological stage listed in slides:",opts:["Dental lamina","Bud","Cap","Bell"],correct:0,explain:"Morphological list starts with dental lamina formation."},
  {q:"Which structure directly separates cheek/lip from teethâ€‘bearing area?",opts:["Oral vestibule formed by vestibular lamina","Dental papilla","Enamel knot","Alveolar septum"],correct:0,explain:"Breakdown within vestibular lamina creates the groove of the vestibule."},
  {q:"The primary epithelial band appears in the jaws as:",opts:["Two horseshoeâ€‘shaped bands","One circular ring","Segmented patches only","A linear midline stripe"],correct:0,explain:"Horseshoeâ€‘shaped bands correspond to future dental arches."},
  {q:"Which cell population induces the ectoderm to proliferate in specific jaw areas?",opts:["Ectomesenchymal cells","Odontoblasts","Osteoclasts","Chondrocytes"],correct:0,explain:"Ectomesenchyme (neural crest) induces epithelial thickening."},
  {q:"During which stage is the enamel organâ€™s shape established?",opts:["Cap to bell (morphodifferentiation)","Initiation only","Apposition","Root formation"],correct:0,explain:"Tooth crown form becomes defined during cap â†’ bell via morphodifferentiation."},
  {q:"Which statement about the vestibular lamina is TRUE?",opts:["It arises buccal to dental lamina","It is lingual to dental lamina","It is a distal extension for molars","It directly forms enamel"],correct:0,explain:"The vestibular lamina forms buccal to the dental lamina."},
  {q:"Which is NOT a derivative of dental lamina?",opts:["Periodontal ligament","Primary tooth buds","Successional lamina","Distal extension for molars"],correct:0,explain:"PDL derives from dental follicle, not from dental lamina epithelium."},
  {q:"Which term describes epithelial remnants within the gingiva/jaw after lamina breakdown?",opts:["Cell rests of Serres","Cell rests of Malassez","Granulation islands","Howship's lacunae"],correct:0,explain:"Rests of Serres are epithelial remnants of the dental lamina."},
  {q:"Match stage and process: Apposition corresponds to:",opts:["Matrix deposition (enamel/dentin) in layers","Initial epithelial thickening","Cell type specification only","Root sheath formation"],correct:0,explain:"Apposition is the laying down of dental hard tissue matrices."},
  {q:"Which comes first in time?",opts:["Initiation","Histodifferentiation","Morphodifferentiation","Apposition"],correct:0,explain:"Initiation precedes all subsequent physiologic stages."},
  {q:"â€˜Lateral laminaâ€™ is named for its relation to:",opts:["Successional lamina (positionally lateral)","Vestibular lamina","Hertwigâ€™s sheath","Dental follicle"],correct:0,explain:"Slides: named so as it describes its relation to the successional lamina."},
];

const tfs = [
  {q:"Epithelialâ€“mesenchymal interactions are essential for odontogenesis.",answer:true,explain:"Defined as essential, reciprocal signaling leading to differentiation."},
  {q:"The stomodeum is initially lined by endoderm.",answer:false,explain:"It is lined by oral ectoderm."},
  {q:"Buccopharyngeal membrane rupture around day 27 establishes continuity with the foregut.",answer:true,explain:"Yesâ€”about the 4th week."},
  {q:"At 5â€“6 weeks IU the oral ectoderm shows 2â€“3 layers including basal columnar cells.",answer:true,explain:"As stated in slides."},
  {q:"Primary epithelial band formation is independent of ectomesenchyme.",answer:false,explain:"It forms under ectomesenchymal (neural crest) influence."},
  {q:"The primary epithelial band gives rise to the enamel organ directly.",answer:false,explain:"It first splits into dental and vestibular laminae; enamel organ arises from dental laminaâ€™s tooth buds."},
  {q:"Vestibular lamina degenerates internally to create the oral vestibule.",answer:true,explain:"Clefting produces the vestibular groove."},
  {q:"Morphological stages include initiation and apposition.",answer:false,explain:"Those are physiologic stages; morphological are dental lamina, bud, cap, bell."},
  {q:"Twenty primary tooth buds appear on the dental lamina.",answer:true,explain:"Yesâ€”approximately in positions of primary teeth."},
  {q:"Permanent molars are successional teeth.",answer:false,explain:"They are nonâ€‘successional; develop from distal extension of dental lamina."},
  {q:"Permanent teeth develop faster than primary teeth.",answer:false,explain:"Slides: permanent teeth develop slower."},
  {q:"Epithelial rests of Serres are remnants of dental lamina.",answer:true,explain:"Correctâ€”found in jaws/gingiva."},
];

const saqs = [
  { q: "Define epithelialâ€“mesenchymal interaction in tooth development and state its significance.", a: "A programmed, sequential, reciprocal communication between epithelium and mesenchyme that drives differentiation of one or both populations; it is essential for odontogenesis." },
  { q: "List the morphological stages and the histophysiological stages of tooth development.", a: "Morphological: dental lamina, bud, cap, early bell, late bell. Histophysiological: initiation, proliferation, histodifferentiation, morphodifferentiation, apposition." },
  { q: "Explain dental vs vestibular lamina and outline their derivatives.", a: "Both arise from the primary epithelial band. Dental lamina â†’ tooth buds (20 primary), successional lamina for permanent successors, distal extension for molars. Vestibular lamina forms buccal to dental lamina and undergoes degeneration/clefting to create the oral vestibule (separating lips/cheeks from teethâ€‘bearing area)." },
];

// ----------- State -----------
const state = {
  mcq: Array(mcqs.length).fill(null), // null | selectedIndex
  tf: Array(tfs.length).fill(null),   // null | boolean
  saq: Array(saqs.length).fill(false) // self-marked
};

function shuffleIndices(n){
  const arr = Array.from({length:n}, (_,i)=>i);
  for(let i=n-1;i>0;i--){
    const j = Math.floor(Math.random()*(i+1));
    [arr[i],arr[j]] = [arr[j],arr[i]];
  }
  return arr;
}

// ----------- Render MCQs -----------
const mcqGrid = document.getElementById('mcqGrid');
mcqs.forEach((item, idx)=>{
  const map = shuffleIndices(4);
  const visualToOriginal = map;
  const originalToVisual = Array(4);
  map.forEach((orig, v)=>{ originalToVisual[orig] = v; });
  const correctVisualIndex = originalToVisual[item.correct];

  const card = document.createElement('article');
  card.className='card qcard';
  card.dataset.type='mcq';
  card.dataset.index = idx;
  card.dataset.locked = 'false';
  card.innerHTML = `
    <p class="meta">Question ${idx+1} of ${mcqs.length}</p>
    <h3 class="qtitle">${item.q}</h3>
    <div class="opts">
      ${[0,1,2,3].map(v=>`
        <button class="opt-btn" data-v="${v}" aria-label="Answer option ${String.fromCharCode(65+v)}">
          <span class="key">${String.fromCharCode(65+v)}</span>
          <span class="label">${item.opts[ visualToOriginal[v] ]}</span>
        </button>
      `).join('')}
    </div>
    <div class="feedback" hidden></div>
  `;

  const buttons = card.querySelectorAll('.opt-btn');
  const feedback = card.querySelector('.feedback');

  function lock(){
    card.dataset.locked = 'true';
    buttons.forEach(b=>b.setAttribute('disabled',''));
  }

  buttons.forEach(btn=>{
    btn.addEventListener('click', ()=>{
      if(card.dataset.locked === 'true') return; // one attempt
      const v = Number(btn.dataset.v);
      state.mcq[idx] = v;

      // clear classes
      buttons.forEach(b=>b.classList.remove('correct','wrong'));

      // Always mark the correct option (green)
      const correctBtn = buttons[correctVisualIndex];
      correctBtn.classList.add('correct');

      if(v !== correctVisualIndex){
        // Mark chosen wrong option (red)
        btn.classList.add('wrong');
        feedback.hidden=false;
        feedback.innerHTML = `<b>Wrong âœ–</b><br>Correct answer: <b>${String.fromCharCode(65+correctVisualIndex)}</b><br>${item.explain}`;
      }else{
        feedback.hidden=false;
        feedback.innerHTML = `<b>Correct âœ”</b><br>Answer: <b>${String.fromCharCode(65+correctVisualIndex)}</b><br>${item.explain}`;
      }
      lock();
      recalc();
    });
  });

  mcqGrid.appendChild(card);
});

// ----------- Render True/False -----------
const tfGrid = document.getElementById('tfGrid');
$tfsLoop: for (let idx=0; idx<tfs.length; idx++){
  const item = tfs[idx];
  const card = document.createElement('article');
  card.className='card qcard';
  card.dataset.type='tf';
  card.dataset.index = idx;
  card.dataset.locked = 'false';
  card.innerHTML = `
    <p class="meta">Statement ${idx+1} of ${tfs.length}</p>
    <h3 class="qtitle">${item.q}</h3>
    <div class="opts">
      <button class="opt-btn" data-v="true">
        <span class="key">T</span><span class="label">True</span>
      </button>
      <button class="opt-btn" data-v="false">
        <span class="key">F</span><span class="label">False</span>
      </button>
    </div>
    <div class="feedback" hidden></div>
  `;

  const buttons = card.querySelectorAll('.opt-btn');
  const feedback = card.querySelector('.feedback');

  function lock(){
    card.dataset.locked = 'true';
    buttons.forEach(b=>b.setAttribute('disabled',''));
  }

  buttons.forEach(btn=>{
    btn.addEventListener('click', ()=>{
      if(card.dataset.locked === 'true') return; // one attempt
      const val = btn.dataset.v === "true";
      state.tf[idx] = val;

      // clear classes
      buttons.forEach(b=>b.classList.remove('correct','wrong'));

      // Always mark the correct button (green)
      const correctBtn = Array.from(buttons).find(b => (b.dataset.v === (item.answer ? "true" : "false")));
      correctBtn.classList.add('correct');

      const isCorrect = (val === item.answer);
      if(!isCorrect){
        // mark chosen wrong (red)
        btn.classList.add('wrong');
        feedback.hidden=false;
        feedback.innerHTML = `<b>Wrong âœ–</b><br>Correct answer: <b>${item.answer ? 'True' : 'False'}</b><br>${item.explain}`;
      }else{
        feedback.hidden=false;
        feedback.innerHTML = `<b>Correct âœ”</b><br>Answer: <b>${item.answer ? 'True' : 'False'}</b><br>${item.explain}`;
      }

      lock();
      recalc();
    });
  });

  tfGrid.appendChild(card);
}

// ----------- Render SAQs -----------
const saqGrid = document.getElementById('saqGrid');
saqs.forEach((item, idx)=>{
  const card = document.createElement('article');
  card.className='card qcard';
  card.dataset.type='saq';
  card.dataset.index = idx;
  card.innerHTML = `
    <h3 class="qtitle">${item.q}</h3>
    <textarea rows="4" placeholder="Type your answer..." style="width:100%;padding:12px;border-radius:12px;background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.14);color:var(--text);"></textarea>
    <div class="btnrow" style="margin-top:10px">
      <button class="primary" data-act="reveal">Reveal Answer</button>
      <button class="ghost" data-act="toggle">I was correct</button>
    </div>
    <div class="answer" hidden>${item.a}</div>
  `;

  const revealBtn = card.querySelector('[data-act="reveal"]');
  const toggleBtn = card.querySelector('[data-act="toggle"]');
  const answer = card.querySelector('.answer');

  revealBtn.addEventListener('click', ()=>{
    answer.hidden = !answer.hidden;
    revealBtn.textContent = answer.hidden ? "Reveal Answer" : "Hide Answer";
  });

  toggleBtn.addEventListener('click', ()=>{
    const now = !state.saq[idx];
    state.saq[idx] = now;
    toggleBtn.textContent = now ? "âœ“ Counted as correct" : "I was correct";
    toggleBtn.style.outline = now ? "2px solid rgba(34,197,94,.7)" : "none";
    recalc();
  });

  saqGrid.appendChild(card);
});

// ----------- Score + Reset -----------
function recalc(){
  const mcqScore = state.mcq.reduce((s,v,i)=>{
    if(v===null) return s;
    const card = document.querySelector(`.qcard[data-type="mcq"][data-index="${i}"]`);
    const feedback = card.querySelector('.feedback').textContent;
    return s + (feedback.startsWith("Correct") ? 1 : 0);
  },0);
  const tfScore = state.tf.reduce((s,v,i)=>{
    if(v===null) return s;
    const card = document.querySelector(`.qcard[data-type="tf"][data-index="${i}"]`);
    const feedback = card.querySelector('.feedback').textContent;
    return s + (feedback.startsWith("Correct") ? 1 : 0);
  },0);
  const saqScore = state.saq.filter(Boolean).length;
  const total = mcqScore + tfScore + saqScore;

  const ids = ["sMcq","sTf","sSaq","sTotal","sMcq2","sTf2","sSaq2","sTotal2"];
  ids.forEach(id=>{
    const el = document.getElementById(id);
    if(!el) return;
    if(id.includes('Mcq')) el.textContent = mcqScore;
    if(id.includes('Tf')) el.textContent = tfScore;
    if(id.includes('Saq')) el.textContent = saqScore;
    if(id.includes('Total')) el.textContent = total;
  });
}

document.getElementById('resetAll').addEventListener('click', ()=>{
  document.querySelectorAll('.qcard .feedback').forEach(f=>{f.hidden=true; f.textContent=''; f.innerHTML='';});
  document.querySelectorAll('.opt-btn').forEach(b=>{
    b.classList.remove('correct','wrong');
    b.removeAttribute('disabled');
  });
  document.querySelectorAll('.qcard[data-type="mcq"], .qcard[data-type="tf"]').forEach(c=>{c.dataset.locked='false';});
  document.querySelectorAll('.qcard[data-type="saq"] textarea').forEach(t=>t.value="");
  document.querySelectorAll('.qcard[data-type="saq"] .answer').forEach(a=>a.hidden=true);
  document.querySelectorAll('.qcard[data-type="saq"] [data-act="reveal"]').forEach(b=>b.textContent="Reveal Answer");
  document.querySelectorAll('.qcard[data-type="saq"] [data-act="toggle"]').forEach(b=>{b.textContent="I was correct"; b.style.outline="none";});

  state.mcq.fill(null); state.tf.fill(null); state.saq.fill(false);
  recalc();
});

recalc();
</script>
</body>
</html>

<!DOCTYPE html>
<html lang="en" style="direction:ltr;">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<title>Interactive Exam ‚Ä¢ Glowing Dark Theme</title>
<meta name="color-scheme" content="dark" />
<style>
  :root{
    --bg:#0b0b12;
    --text:#f6f7fb;
    --muted:#a6afc6;
    --card:rgba(255,255,255,0.05);
    --card-border:rgba(255,255,255,0.12);
    --glass:rgba(255,255,255,0.04);
    --glass-border:rgba(255,255,255,0.10);
    --glow-cyan:#06b6d4;
    --glow-cyan-outer:rgba(6,182,212,0.40);
    --glow-purple:#8b5cf6;
    --glow-purple-outer:rgba(139,92,246,0.35);
    --white-haze:rgba(255,255,255,0.08);
    --white-outer:rgba(255,255,255,0.15);
    --radius:16px;
    --gap:1.25rem;
    --pad:1.5rem;
    --ok:#22c55e;  /* green */
    --bad:#ef4444; /* red */
  }

  *{box-sizing:border-box}
  body{margin:0;font:16px/1.65 Inter,ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto;color:var(--text);background:var(--bg);min-height:100dvh;}
  .wrap{max-width:1100px;margin:0 auto;padding:24px;}

  .titlebar{
    position: static;z-index:10;
    backdrop-filter:saturate(140%) blur(8px);
    background:linear-gradient(180deg,rgba(11,11,18,0.75),rgba(11,11,18,0.35));
    border-bottom:1px solid var(--glass-border);
  }
  .titlebar .inner{max-width:1100px;margin:0 auto;padding:16px 24px;display:grid;gap:8px;align-items:center;}
  .grad-text{
    font-weight:800;
    letter-spacing:.3px;
    background:linear-gradient(90deg,var(--glow-cyan),var(--glow-purple));
    -webkit-background-clip:text;background-clip:text;color:transparent;
    text-shadow:0 0 10px var(--glow-cyan-outer), 0 0 14px var(--glow-purple-outer);
  }
  h1.grad-text{font-size:clamp(1.6rem,2vw+1rem,2.6rem);margin:0;text-align:center;}
  .subtitle{margin:0;text-align:center;color:var(--muted);font-size:0.95rem}

  .section-h{
    margin:28px 0 14px;
    padding:12px 16px;
    border-radius:var(--radius);
    background:var(--glass);
    border:1px solid var(--glass-border);
    box-shadow: 0 2px 10px var(--white-haze), 0 0 18px rgba(255,255,255,0.06), 0 0 30px var(--white-outer);
    text-align:center;
    font-weight:750;
    font-size:1.15rem;
  }
  .section-h .grad-text{font-size:1.3rem;}

  .grid{display:grid;gap:var(--gap)}
  @media (min-width:800px){
    .grid.mcq{grid-template-columns:repeat(2,minmax(0,1fr));}
    .grid.tf {grid-template-columns:repeat(3,minmax(0,1fr));}
  }

  /* Cards (no accent on the card itself) */
  .card{
    background:var(--card);
    border:1px solid var(--card-border);
    border-radius:var(--radius);
    padding:var(--pad);
    box-shadow: 0 2px 8px var(--white-haze), 0 0 0 1px rgba(255,255,255,0.02), 0 0 24px rgba(255,255,255,0.06);
    position:relative;
  }

  .qtitle{font-weight:650;margin:0 0 12px}
  .meta{color:var(--muted);font-size:0.88rem;margin-bottom:10px}

  .opts{display:grid;gap:10px}
  .opt-btn{
    all:unset;cursor:pointer;display:flex;gap:10px;align-items:center;
    padding:12px 14px;border-radius:12px;
    background:rgba(255,255,255,0.03);
    border:1px solid rgba(255,255,255,0.10);
    transition:transform .06s ease, background .15s ease, border-color .15s ease;
  }
  .opt-btn .key{width:28px;height:28px;border-radius:9px;display:grid;place-items:center;font-weight:700;
    background:linear-gradient(90deg,var(--glow-cyan),var(--glow-purple));color:#0b0b12;
    box-shadow:0 0 10px var(--glow-cyan-outer),0 0 10px var(--glow-purple-outer) inset;
  }
  .opt-btn:hover{transform:translateY(-1px);border-color:rgba(255,255,255,0.22);} 

  /* Accent line ONLY on the chosen/correct answer box, no background highlight */
  .opt-btn.correct{
    border-left:6px solid var(--ok);
    outline:none;
    background:rgba(255,255,255,0.03);
  }
  .opt-btn.wrong{
    border-left:6px solid var(--bad);
    outline:none;
    background:rgba(255,255,255,0.03);
  }
  .opt-btn[disabled]{opacity:.85;cursor:not-allowed;pointer-events:none;}

  .feedback{margin-top:10px;border-radius:12px;padding:10px 12px;border:1px dashed rgba(255,255,255,0.18);background:rgba(255,255,255,0.03);color:var(--muted);}
  .feedback[hidden]{display:none;}
  .feedback b{color:var(--text)}

  .answer{margin-top:10px;padding:12px;border-radius:12px;border:1px solid rgba(255,255,255,0.14);background:rgba(255,255,255,0.04)}
  .answer[hidden]{display:none;}
  .btnrow{display:flex;gap:10px;flex-wrap:wrap}
  .ghost, .primary{
    all:unset;cursor:pointer;border-radius:12px;padding:10px 14px;font-weight:650;border:1px solid rgba(255,255,255,0.18);
    background:rgba(255,255,255,0.03);
  }
  .primary{background:linear-gradient(90deg,var(--glow-cyan),var(--glow-purple));color:#0b0b12;border-color:transparent;}

  .score{
    margin:16px 0;padding:12px 14px;border-radius:14px;
    background:var(--glass);border:1px solid var(--glass-border);box-shadow: 0 2px 10px var(--white-haze), 0 0 18px rgba(255,255,255,0.06), 0 0 30px var(--white-outer);
    display:flex;justify-content:space-between;align-items:center;gap:10px;flex-wrap:wrap;
  }
  .score .part{color:var(--muted);font-weight:600}
  .score b{color:var(--text)}
</style>
</head>
<body>
  <header class="titlebar">
    <div class="inner">
      <h1 class="grad-text">ü¶∑ Dentistry 3rd year</h1>
      <p class="subtitle">Test based on Lecture 6</p>
    </div>
  </header>

  <main class="wrap">

    <h2 class="section-h"><span class="grad-text">ÿßŸÑŸÑŸëŸéŸáŸèŸÖŸëŸé ŸÑÿß ÿ≥ŸéŸáŸíŸÑŸé ÿ•ŸêŸÑŸëŸéÿß ŸÖŸéÿß ÿ¨ŸéÿπŸéŸÑŸíÿ™ŸéŸáŸè ÿ≥ŸéŸáŸíŸÑŸãÿßÿå ŸàŸéÿ£ŸéŸÜŸíÿ™Ÿé ÿ™Ÿéÿ¨ŸíÿπŸéŸÑŸè ÿßŸÑÿ≠Ÿéÿ≤ŸíŸÜŸé ÿ•Ÿêÿ∞Ÿéÿß ÿ¥Ÿêÿ¶Ÿíÿ™Ÿé ÿ≥ŸéŸáŸíŸÑŸãÿß</span></h2>

    <section class="score" id="scoreTop">
      <div class="part">MCQs: <b><span id="sMcq">0</span>/30</b></div>
      <div class="part">True/False: <b><span id="sTf">0</span>/9</b></div>
      <div class="part">SAQs: <b><span id="sSaq">0</span>/6</b></div>
      <div class="part">Total: <b><span id="sTotal">0</span>/45</b></div>
      <div class="btnrow">
        <button class="ghost" id="resetAll">Reset</button>
      </div>
    </section>

    <h2 class="section-h"><span class="grad-text">MCQs</span></h2>
    <div class="grid mcq" id="mcqGrid"></div>

    <h2 class="section-h"><span class="grad-text">True / False</span></h2>
    <div class="grid tf" id="tfGrid"></div>

    <h2 class="section-h"><span class="grad-text">Short Answer Questions</span></h2>
    <div class="grid" id="saqGrid"></div>

    <section class="score" id="scoreBottom">
      <div class="part">MCQs: <b><span id="sMcq2">0</span>/30</b></div>
      <div class="part">True/False: <b><span id="sTf2">0</span>/9</b></div>
      <div class="part">SAQs: <b><span id="sSaq2">0</span>/6</b></div>
      <div class="part">Total: <b><span id="sTotal2">0</span>/45</b></div>
    </section>
  </main>

<script>
// ----------- Data (filled from Lecture 6: Tooth development & Dental/Vestibular Lamina) -----------
const mcqs = [
  { q:"Epithelial‚Äìmesenchymal interaction in odontogenesis best refers to:",
    opts:[
      "Programmed, sequential, reciprocal signaling between oral epithelium and ectomesenchyme",
      "Passive diffusion of nutrients from enamel organ to dental papilla",
      "Random contact between epithelial rests and bone marrow",
      "Unidirectional control of epithelium over mesenchyme"
    ], correct:0, explain:"Defined as programmed, sequential and reciprocal communications between epithelium and mesenchyme essential for tooth development." },

  { q:"The primitive oral cavity (stomodeum) is lined by:",
    opts:["Simple cuboidal endoderm","Stratified squamous oral ectoderm","Pseudostratified ciliated epithelium","Mesothelium"],
    correct:1, explain:"Stomodeum is lined by oral ectoderm (stratified squamous)." },

  { q:"The buccopharyngeal membrane ruptures approximately at:",
    opts:["End of 2nd week (14th day)","4th week (‚âà27th day) of IUL","7th week (‚âà49th day)","At birth"],
    correct:1, explain:"Rupture occurs in the 4th week, around day 27, establishing continuity with foregut." },

  { q:"Which is the correct sequence of histophysiological stages?",
    opts:["Initiation ‚Üí Proliferation ‚Üí Histo-differentiation ‚Üí Morpho-differentiation ‚Üí Apposition",
          "Proliferation ‚Üí Initiation ‚Üí Morpho-differentiation ‚Üí Apposition ‚Üí Histo-differentiation",
          "Initiation ‚Üí Morpho-differentiation ‚Üí Histo-differentiation ‚Üí Proliferation ‚Üí Apposition",
          "Apposition ‚Üí Initiation ‚Üí Proliferation ‚Üí Histo-differentiation ‚Üí Morpho-differentiation"],
    correct:0, explain:"The classic order is Initiation, Proliferation, Histo-differentiation, Morpho-differentiation, then Apposition." },

  { q:"Which set lists the morphological stages correctly?",
    opts:["Bud ‚Üí Cap ‚Üí Bell (early/late)","Cap ‚Üí Bud ‚Üí Bell","Bell ‚Üí Bud ‚Üí Cap","Initiation ‚Üí Bud ‚Üí Bell"],
    correct:0, explain:"Morphological stages: bud, cap, and bell (early and late)." },

  { q:"The ectomesenchyme involved in odontogenesis is primarily derived from:",
    opts:["Somitic mesoderm","Neural crest cells","Lateral plate mesoderm","Endoderm"],
    correct:1, explain:"Oral ectomesenchyme originates mainly from cranial neural crest cells." },

  { q:"At 5‚Äì6 weeks in utero, the oral ectoderm typically shows:",
    opts:["A single layer of cuboidal cells","Basal columnar and superficial flat layers (2‚Äì3 layers)","Keratinized stratified squamous epithelium","Transitional epithelium"],
    correct:1, explain:"The primitive oral cavity is lined by ectoderm with 2‚Äì3 layers: basal columnar & superficial flat cells." },

  { q:"The primary epithelial band first appears as:",
    opts:["A circular collar around the tongue","Two horseshoe-shaped thickenings in maxillary and mandibular arches","Multiple isolated nodules in the palate","A sagittal ridge along the midline"],
    correct:1, explain:"Primary epithelial band forms as horseshoe-shaped bands for future arches." },

  { q:"The primary epithelial band gives rise to:",
    opts:["Dental lamina and vestibular lamina","Enamel lamellae and enamel tufts","Hertwig‚Äôs epithelial root sheath and Malassez rests","Nasmyth‚Äôs membrane and reduced enamel epithelium"],
    correct:0, explain:"It divides into dental and vestibular laminae." },

  { q:"Main function of the vestibular lamina:",
    opts:["Induce root formation","Form the oral vestibule by epithelial degeneration/clefting","Produce enamel","Give rise to permanent molars"],
    correct:1, explain:"Degeneration within vestibular lamina forms the groove of the oral vestibule." },

  { q:"How many primary tooth buds arise from the dental lamina?",
    opts:["16","20","24","32"],
    correct:1, explain:"Twenty tooth buds appear in positions of the primary teeth." },

  { q:"The successional lamina is best described as:",
    opts:["A buccal extension forming the oral vestibule","A lingual extension from primary tooth germs forming permanent successors","A distal extension forming molars","A cervical loop extension forming roots"],
    correct:1, explain:"Successional lamina extends lingually and forms incisors, canines, and premolars." },

  { q:"Permanent molars develop from:",
    opts:["Successional lamina (lingual)","Distal extension of the main dental lamina (non-successional)","Vestibular lamina","Epithelial diaphragm"],
    correct:1, explain:"Molars are non‚Äësuccessional; they arise from distal extension of dental lamina." },

  { q:"The connection between the developing tooth and dental lamina begins to break down during:",
    opts:["Bud stage","Cap stage","Bell stage","Apposition stage"],
    correct:2, explain:"As the tooth reaches the bell stage, its connection to dental lamina breaks down." },

  { q:"Breakdown of the dental lamina proceeds:",
    opts:["Posterior to anterior","Randomly","Simultaneously in all teeth","From anterior to posterior"],
    correct:3, explain:"Breakdown starts in anterior regions and spreads posteriorly." },

  { q:"Epithelial remnants left after dental lamina degeneration are called:",
    opts:["Rests of Malassez","Rests of Serres","Rests of Nasmyth","Rests of Glands of Serous"],
    correct:1, explain:"Degeneration leaves islands known as the cell rests of Serres within jaws/gingiva." },

  { q:"Persistence of dental lamina in the third molar region is typically around:",
    opts:["3 years","5 years","7 years","9 years"],
    correct:1, explain:"Slides note ~5 years in the third molar region." },

  { q:"Which histophysiological stage corresponds most closely with initial formation of the dental lamina?",
    opts:["Apposition","Initiation","Morpho-differentiation","Histo-differentiation"],
    correct:1, explain:"Initiation stage aligns with dental lamina formation." },

  { q:"Which stage is dominated by cell multiplication without marked morphologic change?",
    opts:["Proliferation (Bud stage)","Histo-differentiation","Morpho-differentiation","Apposition"],
    correct:0, explain:"Proliferation corresponds to the bud stage with cell multiplication." },

  { q:"Predominant event of histo-differentiation is:",
    opts:["Shaping of crown outline","Deposition of enamel and dentin","Differentiation of ameloblasts and odontoblasts","Formation of oral vestibule"],
    correct:2, explain:"During histo‚Äëdifferentiation, cells specialize into enamel- and dentin-forming cells." },

  { q:"Morpho-differentiation chiefly determines:",
    opts:["Tissue types present","Crown shape and size","Root number","Eruption path"],
    correct:1, explain:"Morpho‚Äëdifferentiation establishes the crown form prior to hard tissue deposition." },

  { q:"Apposition stage involves:",
    opts:["Neural crest migration","Matrix deposition of enamel and dentin","Formation of buccopharyngeal membrane","Vestibular clefting"],
    correct:1, explain:"Apposition is the deposition of dental hard tissue matrices." },

  { q:"If epithelial‚Äìmesenchymal signaling is disrupted early, the most likely outcome is:",
    opts:["Hypercementosis of roots","Tooth agenesis or severe malformation","Enamel lamellae formation only","Supernumerary roots in all teeth"],
    correct:1, explain:"Failure of reciprocal signaling often yields missing teeth or abnormal morphogenesis." },

  { q:"Which of the following is NON‚Äësuccessional?",
    opts:["Permanent lateral incisor","Permanent canine","First permanent molar","Second premolar"],
    correct:2, explain:"Molars do not replace primary teeth; they arise from distal extension." },

  { q:"Successional lamina extends in which direction relative to the primary tooth germ?",
    opts:["Buccal","Lingual","Distal","Mesial"],
    correct:1, explain:"It is a lingual extension from the primary enamel organ/dental lamina." },

  { q:"Epithelial proliferation into underlying ectomesenchyme is initiated under the influence of:",
    opts:["Endodermal signals","Ectomesenchymal (neural crest) signals","Hypophyseal hormones exclusively","Vascular invasion"],
    correct:1, explain:"Signals from ectomesenchyme induce epithelial thickening and invagination." },

  { q:"Number of horseshoe‚Äëshaped epithelial thickenings of the primary band:",
    opts:["One (maxillary only)","Two (maxillary and mandibular)","Three (adds palatal horseshoe)","Four (adds lateral ridges)"],
    correct:1, explain:"Two bands correspond to future upper and lower arches." },

  { q:"The term ‚Äòlateral dental lamina‚Äô refers to:",
    opts:["Vestibular portion after clefting","Primary tooth lamina after separation from developing tooth, lying lateral to successional lamina","Distal extension forming molars","Lingual extension giving permanent successors"],
    correct:1, explain:"As connection breaks at bell stage, the primary tooth lamina becomes the lateral lamina relative to the successional one." },

  { q:"Which event creates the groove separating lips/cheeks from tooth-bearing areas?",
    opts:["Degeneration within vestibular lamina","Fusion of palatal shelves","Breakdown of dental lamina","Eruption of first molars"],
    correct:0, explain:"Clefting/degeneration in vestibular lamina forms the oral vestibule." },

  { q:"Which membrane is formed where oral ectoderm contacts foregut endoderm?",
    opts:["Pharyngeal arch membrane","Buccopharyngeal membrane","Basement membrane of enamel organ","Meckel‚Äôs membrane"],
    correct:1, explain:"Oral ectoderm meets endoderm to form the buccopharyngeal membrane." }
];

const tfs = [
  { q:"Epithelial‚Äìmesenchymal interactions are reciprocal and essential in odontogenesis.", answer:true, explain:"They are sequential and reciprocal communications required for tooth development." },
  { q:"The stomodeum is lined primarily by endoderm.", answer:false, explain:"It is lined by oral ectoderm (stratified squamous)." },
  { q:"The buccopharyngeal membrane ruptures during the 8th week of development.", answer:false, explain:"It ruptures around the 4th week (~27th day)." },
  { q:"Permanent molars are successional teeth.", answer:false, explain:"Molars are non‚Äësuccessional; they arise from distal extension of dental lamina." },
  { q:"The successional lamina arises lingual to the primary tooth germ.", answer:true, explain:"It is a lingual extension forming permanent successors." },
  { q:"Degeneration of the dental lamina leaves epithelial rests of Serres in the jaws and gingiva.", answer:true, explain:"These are remnants after breakdown of the lamina." },
  { q:"Breakdown of the dental lamina begins posteriorly and proceeds anteriorly.", answer:false, explain:"It begins in anterior teeth and spreads posteriorly." },
  { q:"The primary epithelial band is evident around 6 weeks in utero.", answer:true, explain:"Slides indicate appearance at ~6 W.I.U." },
  { q:"At 5‚Äì6 W.I.U., the oral ectoderm typically has basal columnar and superficial flat cell layers (2‚Äì3 layers).", answer:true, explain:"This is characteristic of the primitive oral epithelium." }
];

const saqs = [
  // 1) Direct Answer
  { q: "Define epithelial‚Äìmesenchymal interaction in tooth development.",
    a: "Programmed, sequential, reciprocal signaling between oral epithelium and ectomesenchyme leading to cell differentiation." },
  // 2) List / Enumeration (‚â•3)
  { q: "List the histophysiological stages of tooth development.",
    a: "1) Initiation  2) Proliferation  3) Histo-differentiation  4) Morpho-differentiation  5) Apposition" },
  // 3) Comparison as a numbered table
  { q: "Compare successional teeth with non‚Äësuccessional teeth.",
    a: `<table style="width:100%;border-collapse:collapse"><thead><tr><th style="text-align:left;border-bottom:1px solid rgba(255,255,255,0.2)">#</th><th style="text-align:left;border-bottom:1px solid rgba(255,255,255,0.2)">Successional teeth</th><th style="text-align:left;border-bottom:1px solid rgba(255,255,255,0.2)">Non‚Äësuccessional teeth</th></tr></thead><tbody>
      <tr><td>1</td><td>Arise from <b>successional lamina</b> (lingual extension)</td><td>Arise from <b>distal extension</b> of main dental lamina</td></tr>
      <tr><td>2</td><td>Replace primary teeth (incisors, canines, premolars)</td><td>Do not replace any tooth (molars)</td></tr>
    </tbody></table>` },
  // 4) Case-based Scenario
  { q: "A 10‚Äëyear‚Äëold has missing permanent premolars while primary molars were present and normal. Which developmental structure most likely failed?",
    a: "Successional lamina (lingual extension) failed during early stages (bud/cap)." },
  // 5) Direct, factual
  { q: "State when the buccopharyngeal membrane typically ruptures.",
    a: "Around the 4th week (~27th day) of intrauterine life." },
  // 6) Enumeration (‚â•3)
  { q: "List the morphological stages of crown development.",
    a: "1) Bud  2) Cap  3) Bell (early)  4) Bell (late)" }
];

// ----------- State -----------
const state = {
  mcq: Array(mcqs.length).fill(null), // null | selectedIndex
  tf: Array(tfs.length).fill(null),   // null | boolean
  saq: Array(saqs.length).fill(false) // self-marked
};

function shuffleIndices(n){
  const arr = Array.from({length:n}, (_,i)=>i);
  for(let i=n-1;i>0;i--){
    const j = Math.floor(Math.random()*(i+1));
    [arr[i],arr[j]] = [arr[j],arr[i]];
  }
  return arr;
}

// ----------- Render MCQs -----------
const mcqGrid = document.getElementById('mcqGrid');
mcqs.forEach((item, idx)=>{
  const map = shuffleIndices(4);
  const visualToOriginal = map;
  const originalToVisual = Array(4);
  map.forEach((orig, v)=>{ originalToVisual[orig] = v; });
  const correctVisualIndex = originalToVisual[item.correct];

  const card = document.createElement('article');
  card.className='card qcard';
  card.dataset.type='mcq';
  card.dataset.index = idx;
  card.dataset.locked = 'false';
  card.innerHTML = `
    <p class="meta">Question ${idx+1} of ${mcqs.length}</p>
    <h3 class="qtitle">${item.q}</h3>
    <div class="opts">
      ${[0,1,2,3].map(v=>`
        <button class="opt-btn" data-v="${v}" aria-label="Answer option ${String.fromCharCode(65+v)}">
          <span class="key">${String.fromCharCode(65+v)}</span>
          <span class="label">${item.opts[ visualToOriginal[v] ]}</span>
        </button>
      `).join('')}
    </div>
    <div class="feedback" hidden></div>
  `;

  const buttons = card.querySelectorAll('.opt-btn');
  const feedback = card.querySelector('.feedback');

  function lock(){
    card.dataset.locked = 'true';
    buttons.forEach(b=>b.setAttribute('disabled',''));
  }

  buttons.forEach(btn=>{
    btn.addEventListener('click', ()=>{
      if(card.dataset.locked === 'true') return; // one attempt
      const v = Number(btn.dataset.v);
      state.mcq[idx] = v;

      // clear classes
      buttons.forEach(b=>b.classList.remove('correct','wrong'));

      // Always mark the correct option (green)
      const correctBtn = buttons[correctVisualIndex];
      correctBtn.classList.add('correct');

      if(v !== correctVisualIndex){
        // Mark chosen wrong option (red)
        btn.classList.add('wrong');
        feedback.hidden=false;
        feedback.innerHTML = `<b>Wrong ‚úñ</b><br>Correct answer: <b>${String.fromCharCode(65+correctVisualIndex)}</b><br>${item.explain}`;
      }else{
        feedback.hidden=false;
        feedback.innerHTML = `<b>Correct ‚úî</b><br>Answer: <b>${String.fromCharCode(65+correctVisualIndex)}</b><br>${item.explain}`;
      }
      lock();
      recalc();
    });
  });

  mcqGrid.appendChild(card);
});

// ----------- Render True/False -----------
const tfGrid = document.getElementById('tfGrid');
 tfs.forEach((item, idx)=>{
  const card = document.createElement('article');
  card.className='card qcard';
  card.dataset.type='tf';
  card.dataset.index = idx;
  card.dataset.locked = 'false';
  card.innerHTML = `
    <p class="meta">Statement ${idx+1} of ${tfs.length}</p>
    <h3 class="qtitle">${item.q}</h3>
    <div class="opts">
      <button class="opt-btn" data-v="true">
        <span class="key">T</span><span class="label">True</span>
      </button>
      <button class="opt-btn" data-v="false">
        <span class="key">F</span><span class="label">False</span>
      </button>
    </div>
    <div class="feedback" hidden></div>
  `;

  const buttons = card.querySelectorAll('.opt-btn');
  const feedback = card.querySelector('.feedback');

  function lock(){
    card.dataset.locked = 'true';
    buttons.forEach(b=>b.setAttribute('disabled',''));
  }

  buttons.forEach(btn=>{
    btn.addEventListener('click', ()=>{
      if(card.dataset.locked === 'true') return; // one attempt
      const val = btn.dataset.v === "true";
      state.tf[idx] = val;

      // clear classes
      buttons.forEach(b=>b.classList.remove('correct','wrong'));

      // Always mark the correct button (green)
      const correctBtn = Array.from(buttons).find(b => (b.dataset.v === (item.answer ? "true" : "false")));
      correctBtn.classList.add('correct');

      const isCorrect = (val === item.answer);
      if(!isCorrect){
        // mark chosen wrong (red)
        btn.classList.add('wrong');
        feedback.hidden=false;
        feedback.innerHTML = `<b>Wrong ‚úñ</b><br>Correct answer: <b>${item.answer ? 'True' : 'False'}</b><br>${item.explain}`;
      }else{
        feedback.hidden=false;
        feedback.innerHTML = `<b>Correct ‚úî</b><br>Answer: <b>${item.answer ? 'True' : 'False'}</b><br>${item.explain}`;
      }

      lock();
      recalc();
    });
  });

  tfGrid.appendChild(card);
});

// ----------- Render SAQs -----------
const saqGrid = document.getElementById('saqGrid');
saqs.forEach((item, idx)=>{
  const card = document.createElement('article');
  card.className='card qcard';
  card.dataset.type='saq';
  card.dataset.index = idx;
  card.innerHTML = `
  <p class="meta">Question ${idx + 1} of ${saqs.length}</p>
  <h3 class="qtitle">${item.q}</h3>
  <textarea rows="4" placeholder="Type your answer..." style="width:100%;padding:12px;border-radius:12px;background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.14);color:var(--text);"></textarea>
  <div class="btnrow" style="margin-top:10px">
    <button class="primary" data-act="reveal">Reveal Answer</button>
    <button class="ghost" data-act="toggle">I was correct</button>
  </div>
  <div class="answer" hidden>${item.a}</div>
`;


  const revealBtn = card.querySelector('[data-act="reveal"]');
  const toggleBtn = card.querySelector('[data-act="toggle"]');
  const answer = card.querySelector('.answer');

  revealBtn.addEventListener('click', ()=>{
    answer.hidden = !answer.hidden;
    revealBtn.textContent = answer.hidden ? "Reveal Answer" : "Hide Answer";
  });

  toggleBtn.addEventListener('click', ()=>{
    const now = !state.saq[idx];
    state.saq[idx] = now;
    toggleBtn.textContent = now ? "‚úì Counted as correct" : "I was correct";
    toggleBtn.style.outline = now ? "2px solid rgba(34,197,94,.7)" : "none";
    recalc();
  });

  saqGrid.appendChild(card);
});

// ----------- Score + Reset -----------
function recalc(){
  const mcqScore = state.mcq.reduce((s,v,i)=>{
    if(v===null) return s;
    const card = document.querySelector(`.qcard[data-type="mcq"][data-index="${i}"]`);
    const feedback = card.querySelector('.feedback').textContent;
    return s + (feedback.startsWith("Correct") ? 1 : 0);
  },0);
  const tfScore = state.tf.reduce((s,v,i)=>{
    if(v===null) return s;
    const card = document.querySelector(`.qcard[data-type="tf"][data-index="${i}"]`);
    const feedback = card.querySelector('.feedback').textContent;
    return s + (feedback.startsWith("Correct") ? 1 : 0);
  },0);
  const saqScore = state.saq.filter(Boolean).length;
  const total = mcqScore + tfScore + saqScore;

  const ids = ["sMcq","sTf","sSaq","sTotal","sMcq2","sTf2","sSaq2","sTotal2"];
  ids.forEach(id=>{
    const el = document.getElementById(id);
    if(!el) return;
    if(id.includes('Mcq')) el.textContent = mcqScore;
    if(id.includes('Tf')) el.textContent = tfScore;
    if(id.includes('Saq')) el.textContent = saqScore;
    if(id.includes('Total')) el.textContent = total;
  });
}

document.getElementById('resetAll').addEventListener('click', ()=>{
  document.querySelectorAll('.qcard .feedback').forEach(f=>{f.hidden=true; f.textContent=''; f.innerHTML='';});
  document.querySelectorAll('.opt-btn').forEach(b=>{
    b.classList.remove('correct','wrong');
    b.removeAttribute('disabled');
  });
  document.querySelectorAll('.qcard[data-type="mcq"], .qcard[data-type="tf"]').forEach(c=>{c.dataset.locked='false';});
  document.querySelectorAll('.qcard[data-type="saq"] textarea').forEach(t=>t.value="");
  document.querySelectorAll('.qcard[data-type="saq"] .answer').forEach(a=>a.hidden=true);
  document.querySelectorAll('.qcard[data-type="saq"] [data-act="reveal"]').forEach(b=>b.textContent="Reveal Answer");
  document.querySelectorAll('.qcard[data-type="saq"] [data-act="toggle"]').forEach(b=>{b.textContent="I was correct"; b.style.outline="none";});

  state.mcq.fill(null); state.tf.fill(null); state.saq.fill(false);
  recalc();
});

recalc();
</script>
</body>
</html>

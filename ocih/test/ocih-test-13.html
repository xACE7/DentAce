<!DOCTYPE html>
<html lang="en" style="direction:ltr;">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<title>Interactive Exam • Glowing Dark Theme</title>
<meta name="color-scheme" content="dark" />
<style>
  :root{
    --bg:#0b0b12;
    --text:#f6f7fb;
    --muted:#a6afc6;
    --card:rgba(255,255,255,0.05);
    --card-border:rgba(255,255,255,0.12);
    --glass:rgba(255,255,255,0.04);
    --glass-border:rgba(255,255,255,0.10);
    --glow-cyan:#06b6d4;
    --glow-cyan-outer:rgba(6,182,212,0.40);
    --glow-purple:#8b5cf6;
    --glow-purple-outer:rgba(139,92,246,0.35);
    --white-haze:rgba(255,255,255,0.08);
    --white-outer:rgba(255,255,255,0.15);
    --radius:16px;
    --gap:1.25rem;
    --pad:1.5rem;
    --ok:#22c55e;  /* green */
    --bad:#ef4444; /* red */
  }

  *{box-sizing:border-box}
  body{margin:0;font:16px/1.65 Inter,ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto;color:var(--text);background:var(--bg);min-height:100dvh;}
  .wrap{max-width:1100px;margin:0 auto;padding:24px;}

  .titlebar{
    position: static;z-index:10;
    backdrop-filter:saturate(140%) blur(8px);
    background:linear-gradient(180deg,rgba(11,11,18,0.75),rgba(11,11,18,0.35));
    border-bottom:1px solid var(--glass-border);
  }
  .titlebar .inner{max-width:1100px;margin:0 auto;padding:16px 24px;display:grid;gap:8px;align-items:center;}
  .grad-text{
    font-weight:800;
    letter-spacing:.3px;
    background:linear-gradient(90deg,var(--glow-cyan),var(--glow-purple));
    -webkit-background-clip:text;background-clip:text;color:transparent;
    text-shadow:0 0 10px var(--glow-cyan-outer), 0 0 14px var(--glow-purple-outer);
  }
  h1.grad-text{font-size:clamp(1.6rem,2vw+1rem,2.6rem);margin:0;text-align:center;}
  .subtitle{margin:0;text-align:center;color:var(--muted);font-size:0.95rem}

  .section-h{
    margin:28px 0 14px;
    padding:12px 16px;
    border-radius:var(--radius);
    background:var(--glass);
    border:1px solid var(--glass-border);
    box-shadow: 0 2px 10px var(--white-haze), 0 0 18px rgba(255,255,255,0.06), 0 0 30px var(--white-outer);
    text-align:center;
    font-weight:750;
    font-size:1.15rem;
  }
  .section-h .grad-text{font-size:1.3rem;}

  .grid{display:grid;gap:var(--gap)}
  @media (min-width:800px){
    .grid.mcq{grid-template-columns:repeat(2,minmax(0,1fr));}
    .grid.tf {grid-template-columns:repeat(3,minmax(0,1fr));}
  }

  /* Cards (no accent on the card itself) */
  .card{
    background:var(--card);
    border:1px solid var(--card-border);
    border-radius:var(--radius);
    padding:var(--pad);
    box-shadow: 0 2px 8px var(--white-haze), 0 0 0 1px rgba(255,255,255,0.02), 0 0 24px rgba(255,255,255,0.06);
    position:relative;
  }

  .qtitle{font-weight:650;margin:0 0 12px}
  .meta{color:var(--muted);font-size:0.88rem;margin-bottom:10px}

  .opts{display:grid;gap:10px}
  .opt-btn{
    all:unset;cursor:pointer;display:flex;gap:10px;align-items:center;
    padding:12px 14px;border-radius:12px;
    background:rgba(255,255,255,0.03);
    border:1px solid rgba(255,255,255,0.10);
    transition:transform .06s ease, background .15s ease, border-color .15s ease;
  }
  .opt-btn .key{width:28px;height:28px;border-radius:9px;display:grid;place-items:center;font-weight:700;
    background:linear-gradient(90deg,var(--glow-cyan),var(--glow-purple));color:#0b0b12;
    box-shadow:0 0 10px var(--glow-cyan-outer),0 0 10px var(--glow-purple-outer) inset;
  }
  .opt-btn:hover{transform:translateY(-1px);border-color:rgba(255,255,255,0.22);}

  /* Accent line ONLY on the chosen/correct answer box, no background highlight */
  .opt-btn.correct{
    border-left:6px solid var(--ok);
    outline:none;
    background:rgba(255,255,255,0.03);
  }
  .opt-btn.wrong{
    border-left:6px solid var(--bad);
    outline:none;
    background:rgba(255,255,255,0.03);
  }
  .opt-btn[disabled]{opacity:.85;cursor:not-allowed;pointer-events:none;}

  .feedback{margin-top:10px;border-radius:12px;padding:10px 12px;border:1px dashed rgba(255,255,255,0.18);background:rgba(255,255,255,0.03);color:var(--muted);}
  .feedback[hidden]{display:none;}
  .feedback b{color:var(--text)}

  .answer{margin-top:10px;padding:12px;border-radius:12px;border:1px solid rgba(255,255,255,0.14);background:rgba(255,255,255,0.04)}
  .answer[hidden]{display:none;}
  .answer ol, .answer ul { padding-left: 20px; margin-top: 5px; }
  .answer table { width: 100%; border-collapse: collapse; margin-top: 10px; }
  .answer th, .answer td { border: 1px solid var(--card-border); padding: 8px; text-align: left; }
  .answer th { background-color: var(--glass); }

  .btnrow{display:flex;gap:10px;flex-wrap:wrap}
  .ghost, .primary{
    all:unset;cursor:pointer;border-radius:12px;padding:10px 14px;font-weight:650;border:1px solid rgba(255,255,255,0.18);
    background:rgba(255,255,255,0.03);
  }
  .primary{background:linear-gradient(90deg,var(--glow-cyan),var(--glow-purple));color:#0b0b12;border-color:transparent;}

  .score{
    margin:16px 0;padding:12px 14px;border-radius:14px;
    background:var(--glass);border:1px solid var(--glass-border);box-shadow: 0 2px 10px var(--white-haze), 0 0 18px rgba(255,255,255,0.06), 0 0 30px var(--white-outer);
    display:flex;justify-content:space-between;align-items:center;gap:10px;flex-wrap:wrap;
  }
  .score .part{color:var(--muted);font-weight:600}
  .score b{color:var(--text)}
</style>
</head>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-57Q3BDNKFW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-57Q3BDNKFW');
</script>
<body>
  <header class="titlebar">
    <div class="inner">
      <h1 class="grad-text">🦷 Dentistry 3rd year</h1>
      <p class="subtitle">Test based on Lecture 13</p>
    </div>
  </header>

  <main class="wrap">

    <h2 class="section-h"><span class="grad-text">اللَّهُمَّ لا سَهْلَ إِلَّا مَا جَعَلْتَهُ سَهْلًا، وَأَنْتَ تَجْعَلُ الحَزْنَ إِذَا شِئْتَ سَهْلًا</span></h2>

    <section class="score" id="scoreTop">
      <div class="part">MCQs: <b><span id="sMcq">0</span>/30</b></div>
      <div class="part">True/False: <b><span id="sTf">0</span>/9</b></div>
      <div class="part">SAQs: <b><span id="sSaq">0</span>/6</b></div>
      <div class="part">Total: <b><span id="sTotal">0</span>/45</b></div>
      <div class="btnrow">
        <button class="ghost" id="resetAll">Reset</button>
      </div>
    </section>

    <h2 class="section-h"><span class="grad-text">MCQs</span></h2>
    <div class="grid mcq" id="mcqGrid"></div>

    <h2 class="section-h"><span class="grad-text">True / False</span></h2>
    <div class="grid tf" id="tfGrid"></div>

    <h2 class="section-h"><span class="grad-text">Short Answer Questions</span></h2>
    <div class="grid" id="saqGrid"></div>

    <section class="score" id="scoreBottom">
      <div class="part">MCQs: <b><span id="sMcq2">0</span>/30</b></div>
      <div class="part">True/False: <b><span id="sTf2">0</span>/9</b></div>
      <div class="part">SAQs: <b><span id="sSaq2">0</span>/6</b></div>
      <div class="part">Total: <b><span id="sTotal2">0</span>/45</b></div>
    </section>
  </main>

<script>
// ----------- Data -----------
const mcqs = [
  {
    "q": "Which of the following paranasal sinuses is the first to develop?",
    "opts": ["Maxillary Sinus", "Frontal Sinus", "Sphenoid Sinus", "Ethmoid Sinus"],
    "correct": 0,
    "explain": "The maxillary sinus begins its development in the 2nd gestational month, making it the first of the paranasal sinuses to develop."
  },
  {
    "q": "The maxillary sinus is also known as:",
    "opts": ["Antrum of Highmore", "Sphenoidal Cell", "Frontal Cell", "Ethmoidal Labyrinth"],
    "correct": 0,
    "explain": "The maxillary sinus, located in the maxillary bones under the eyes, is also referred to as the Antrum of Highmore."
  },
  {
    "q": "What is the approximate volume of an adult maxillary sinus?",
    "opts": ["15 ml", "5 ml", "25 ml", "35 ml"],
    "correct": 0,
    "explain": "The average volume of the maxillary sinus in an adult is approximately 15 ml."
  },
  {
    "q": "The roof of the maxillary sinus is formed by the:",
    "opts": ["Floor of the orbit", "Alveolar process of the maxilla", "Lateral wall of the nasal cavity", "Zygomatic process of the maxilla"],
    "correct": 0,
    "explain": "The roof (superior wall) of the maxillary sinus is formed by the floor of the orbit."
  },
  {
    "q": "The floor of the maxillary sinus is formed by the:",
    "opts": ["Alveolar process and palatal process of maxilla", "Floor of the orbit", "Infratemporal surface of maxilla", "Lateral wall of the nasal cavity"],
    "correct": 0,
    "explain": "The floor (inferior wall) of the maxillary sinus is formed by the alveolar and palatal processes of the maxilla."
  },
  {
    "q": "Dental infections from which teeth are most likely to spread to the maxillary sinus?",
    "opts": ["Upper premolars and molars", "Upper incisors and canines", "Lower molars", "Lower premolars"],
    "correct": 0,
    "explain": "The floor of the sinus is very close to the apices of the upper premolars and molars, making them the most likely source of sinus infections of dental origin."
  },
  {
    "q": "Which structure runs along the superior wall of the maxillary sinus?",
    "opts": ["Infraorbital canal", "Posterior superior alveolar canal", "Greater palatine foramen", "Nasal septum"],
    "correct": 0,
    "explain": "The infraorbital canal, containing the infraorbital nerve and vessels, runs along the roof (superior wall) of the maxillary sinus."
  },
  {
    "q": "The main blood supply to the maxillary sinus comes from branches of the:",
    "opts": ["Maxillary artery", "Facial artery", "Internal carotid artery", "Lingual artery"],
    "correct": 0,
    "explain": "The primary arterial supply to the maxillary sinus is from branches of the maxillary artery, including the infraorbital and superior alveolar arteries."
  },
  {
    "q": "Venous drainage from the maxillary sinus primarily flows into the:",
    "opts": ["Facial vein & Pterygoid plexus of veins", "Internal jugular vein", "Cavernous sinus directly", "Superior ophthalmic vein"],
    "correct": 0,
    "explain": "The veins draining the maxillary sinus lead into the facial vein and the pterygoid plexus of veins."
  },
  {
    "q": "Lymphatic drainage from the anterior part of the maxillary sinus goes to which nodes?",
    "opts": ["Submandibular lymph nodes", "Deep cervical nodes", "Preauricular nodes", "Parotid nodes"],
    "correct": 0,
    "explain": "The lymphatic vessels from the anterior portion of the sinus drain into the submandibular lymph nodes."
  },
  {
    "q": "Which of the following is NOT a primary function of the paranasal sinuses?",
    "opts": ["Aiding in mastication", "Warming and humidifying inhaled air", "Decreasing the weight of the skull", "Increasing voice resonance"],
    "correct": 0,
    "explain": "While sinuses contribute to air warming, skull weight reduction, and voice resonance, they do not play a direct role in mastication."
  },
  {
    "q": "A surgical procedure to augment bone volume in the posterior maxilla for implant placement is called:",
    "opts": ["Sinus lift", "Apicoectomy", "Gingivectomy", "Frenectomy"],
    "correct": 0,
    "explain": "A sinus lift procedure is performed when the maxillary sinus floor is too low, to increase the amount of bone available for dental implant placement."
  },
  {
    "q": "What is a potential complication during the extraction of a maxillary molar, related to the sinus?",
    "opts": ["Oroantral communication", "Mandibular fracture", "Nerve paresthesia", "Dry socket"],
    "correct": 0,
    "explain": "Due to the proximity of the molar roots to the sinus floor, a perforation can occur, creating an oroantral communication (fistula)."
  },
  {
    "q": "Which radiographic view is considered the 'gold standard' for visualizing the maxillary sinuses, especially for fluid levels?",
    "opts": ["Water's View", "Intraoral Periapical Radiograph (IOPAR)", "Orthopantograph (OPG)", "True Lateral Skull View"],
    "correct": 0,
    "explain": "The Water's View (Occipitomental view) is the standard and most effective radiographic projection for evaluating the maxillary sinuses for fluid and pathology."
  },
  {
    "q": "On a radiograph, a healthy maxillary sinus appears as a:",
    "opts": ["Radiolucent cavity with corticated borders", "Radiopaque mass", "Mixed density lesion", "Fractured space"],
    "correct": 0,
    "explain": "A healthy, air-filled sinus appears as a dark (radiolucent) area with a well-defined, white (radiopaque) cortical outline."
  },
  {
    "q": "The apex of the pyramidal-shaped maxillary sinus extends into the:",
    "opts": ["Zygomatic process of the maxilla", "Frontal process of the maxilla", "Alveolar process of the maxilla", "Palatine process of the maxilla"],
    "correct": 1,
    "explain": "The apex of the tetrahedral or pyramidal maxillary sinus points laterally, extending into the zygomatic process of the maxilla."
  },
  {
    "q": "The base of the maxillary sinus forms which structure?",
    "opts": ["Lateral wall of the nasal cavity", "Floor of the orbit", "Anterior wall of the face", "Roof of the mouth"],
    "correct": 0,
    "explain": "The base of the sinus is its medial wall, which is contiguous with the lateral wall of the nasal cavity."
  },
  {
    "q": "At what age does the frontal sinus typically appear and begin to develop?",
    "opts": ["Around 4 months gestation, visible by age 6", "At birth", "Around age 12", "In early adulthood"],
    "correct": 0,
    "explain": "The frontal sinus starts developing around the 4th month of gestation but doesn't become clinically significant or visible until around age 3-6."
  },
  {
    "q": "Which nerves provide sensory innervation to the maxillary sinus?",
    "opts": ["Infraorbital and superior alveolar nerves", "Nasopalatine nerve", "Mandibular nerve", "Glossopharyngeal nerve"],
    "correct": 0,
    "explain": "Innervation is provided by the infraorbital nerve and the anterior, middle, and posterior superior alveolar nerves, all branches of the maxillary nerve (V2)."
  },
  {
    "q": "An infection spreading via venous connections from the maxillary sinus can potentially reach the:",
    "opts": ["Cavernous sinus", "Superior sagittal sinus", "Sigmoid sinus", "Transverse sinus"],
    "correct": 0,
    "explain": "The pterygoid plexus of veins has connections to the cavernous sinus, creating a 'dangerous pathway' for infections to spread intracranially."
  },
  {
    "q": "The growth of the maxillary sinus is described as biphasic, occurring during which age ranges?",
    "opts": ["0-3 years & 7-12 years", "Birth to 1 year & 16-18 years", "4-6 years & 13-15 years", "It grows continuously until age 21"],
    "correct": 0,
    "explain": "The maxillary sinus has two main growth spurts: one from birth to age 3, and a second one from ages 7 to 12."
  },
  {
    "q": "Which sinus group is described as numerous (6-12 per side) intercommunicating spaces?",
    "opts": ["Ethmoidal air sinus", "Frontal sinus", "Sphenoidal sinus", "Maxillary sinus"],
    "correct": 0,
    "explain": "The ethmoid sinuses are not a single cavity but a collection of numerous small, interconnected air cells within the ethmoid bone."
  },
  {
    "q": "The sphenoid sinus is located within the body of which bone?",
    "opts": ["Sphenoid bone", "Frontal bone", "Maxilla", "Ethmoid bone"],
    "correct": 0,
    "explain": "The sphenoid sinus is located centrally in the skull, within the body of the sphenoid bone, behind the nasal cavity."
  },
  {
    "q": "Pain in multiple posterior maxillary teeth can be a symptom of:",
    "opts": ["Acute sinusitis", "Pericoronitis", "Temporomandibular disorder (TMD)", "A cracked lower molar"],
    "correct": 0,
    "explain": "Because the superior alveolar nerves that supply the maxillary molars pass through the walls of the sinus, inflammation (sinusitis) can cause referred pain to these teeth."
  },
  {
    "q": "What is the primary purpose of transillumination in examining the maxillary sinus?",
    "opts": ["As a screening tool for monitoring resolving sinusitis", "To diagnose sinus tumors", "To measure the exact sinus volume", "To replace all radiographic imaging"],
    "correct": 0,
    "explain": "Transillumination is a quick clinical test where a light is shone through the tissues. A sinus filled with fluid (like in sinusitis) will not illuminate as brightly as a healthy, air-filled one. It's used as a basic screening tool."
  },
  {
    "q": "The posterior wall of the maxillary sinus is also known as the:",
    "opts": ["Infratemporal surface", "Facial surface", "Orbital surface", "Nasal surface"],
    "correct": 0,
    "explain": "The posterior wall is formed by the infratemporal surface of the maxilla and is related to the pterygopalatine and infratemporal fossae."
  },
  {
    "q": "Pneumatization of the maxillary sinus spreading inferiorly is associated with:",
    "opts": ["Eruption of permanent teeth", "Loss of primary teeth", "Cranial base growth", "Adolescent growth spurt"],
    "correct": 0,
    "explain": "As permanent teeth erupt, the alveolar process remodels, allowing the sinus to expand downwards (pneumatize) into the space."
  },
  {
    "q": "On an OPG, the roots of maxillary molars can sometimes be misinterpreted as:",
    "opts": ["Maxillary sinus pathology", "Mandibular cysts", "Impacted canines", "Salivary stones"],
    "correct": 0,
    "explain": "The superimposition of molar roots over the sinus floor on a panoramic radiograph can mimic or be mistaken for sinus pathology like polyps or cysts."
  },
  {
    "q": "Lymphatic drainage from the posterior part of the maxillary sinus primarily goes to the:",
    "opts": ["Deep cervical nodes", "Submandibular nodes", "Submental nodes", "Parotid nodes"],
    "correct": 0,
    "explain": "While the anterior part drains to submandibular nodes, the posterior part of the sinus drains to the deep cervical lymph nodes."
  },
  {
    "q": "The maxillary sinus drains into the nasal cavity through an opening in the:",
    "opts": ["Middle meatus", "Superior meatus", "Inferior meatus", "Sphenoethmoidal recess"],
    "correct": 0,
    "explain": "All paranasal sinuses, including the maxillary sinus, drain into the nasal cavity. The maxillary sinus ostium opens into the middle meatus."
  }
];

const tfs = [
  {
    "q": "The maxillary sinuses are typically fluid-filled at birth.",
    "answer": true,
    "explain": "The maxillary sinuses are the first to develop and are indeed usually fluid-filled at birth, which clears shortly after."
  },
  {
    "q": "The frontal sinus is the largest of all the paranasal sinuses.",
    "answer": false,
    "explain": "The maxillary sinus is the largest of the paranasal sinuses, with an average volume of 15 ml."
  },
  {
    "q": "All paranasal sinuses drain into the middle meatus of the nasal cavity.",
    "answer": false,
    "explain": "While the maxillary, frontal, and anterior ethmoid sinuses drain into the middle meatus, the posterior ethmoid and sphenoid sinuses drain elsewhere."
  },
  {
    "q": "An oroantral communication is a common complication associated with extracting mandibular molars.",
    "answer": false,
    "explain": "An oroantral communication is a risk when extracting maxillary (upper) posterior teeth, not mandibular (lower) teeth, due to the proximity of their roots to the sinus floor."
  },
  {
    "q": "The walls of the maxillary sinus are supplied by a single, dedicated artery.",
    "answer": false,
    "explain": "The maxillary sinus receives a rich blood supply from multiple branches of the maxillary artery, including the infraorbital, greater palatine, and superior alveolar arteries."
  },
  {
    "q": "Bilateral maxillary sinusitis is more likely to be caused by a bacterial infection than allergies.",
    "answer": false,
    "explain": "Bilateral findings are often associated with systemic causes like allergies, whereas unilateral sinusitis is more indicative of a localized bacterial infection or lesion."
  },
  {
    "q": "The Submentovertex radiographic view is primarily used to evaluate the sphenoidal sinus.",
    "answer": true,
    "explain": "The Submentovertex (SMV) view is ideal for visualizing the base of the skull, including the sphenoidal sinuses."
  },
  {
    "q": "The paranasal sinuses increase the relative weight of the skull.",
    "answer": false,
    "explain": "The air-filled sinuses actually decrease the relative weight of the skull, making it lighter than it would be if it were solid bone."
  },
  {
    "q": "Maxillary sinusitis rarely produces visible soft-tissue swelling on the face.",
    "answer": true,
    "explain": "Unlike infections in other areas, maxillary sinusitis typically does not cause external, visible swelling of the cheek unless there is a significant complication."
  }
];

const saqs = [
  {
    "q": "Describe the shape of the maxillary sinus and list its four main walls or boundaries.",
    "a": "The maxillary sinus is described as a tetrahedral or pyramidal structure. Its boundaries are:<br><ol><li><b>Roof (Superior Wall):</b> Formed by the floor of the orbit.</li><li><b>Floor (Inferior Wall):</b> Formed by the alveolar and palatal processes of the maxilla.</li><li><b>Medial Wall (Base):</b> Formed by the lateral wall of the nasal cavity.</li><li><b>Posterior Wall (Infratemporal Surface):</b> Formed by the infratemporal surface of the maxilla.</li></ol>"
  },
  {
    "q": "List three distinct functions of the paranasal sinuses.",
    "a": "The paranasal sinuses have several functions, including: <br><ol><li><b>Warming and humidifying inhaled air:</b> The mucosal lining moistens and warms air before it reaches the lungs.</li><li><b>Decreasing the relative weight of the skull:</b> The air-filled cavities make the skull lighter.</li><li><b>Increasing resonance of the voice:</b> They act as resonating chambers for sound production.</li></ol> (Other valid answers include acting as shock absorbers and immune defense)."
  },
  {
    "q": "Compare the lymphatic drainage of the anterior and posterior parts of the maxillary sinus.",
    "a": "The lymphatic drainage of the maxillary sinus differs based on the region:<table><tr><th>Sinus Region</th><th>Drains To</th></tr><tr><td>1. Anterior Part</td><td>Submandibular lymph nodes</td></tr><tr><td>2. Posterior Part</td><td>Deep cervical nodes</td></tr></table>"
  },
  {
    "q": "A 45-year-old patient complains of a dull, aching pain in their upper left molars that worsens when they bend over. They had a cold last week. What is a likely diagnosis related to the maxillary sinus, and why does it cause dental pain?",
    "a": "A likely diagnosis is <b>acute maxillary sinusitis</b>. The proximity of the maxillary molar roots to the sinus floor means that inflammation and pressure buildup within the sinus can irritate the superior alveolar nerves, which supply these teeth. This irritation is perceived as tooth pain (referred pain). The pain worsens on bending over due to the gravitational shift of sinus fluid, which increases pressure."
  },
  {
    "q": "List the four main groups of paranasal air sinuses.",
    "a": "The four groups of paranasal sinuses are:<br><ol><li>Frontal Sinuses</li><li>Ethmoidal Sinuses</li><li>Sphenoidal Sinus</li><li>Maxillary Sinuses</li></ol>"
  },
  {
    "q": "Explain the clinical significance of the maxillary sinus in relation to dental implant placement in the posterior maxilla.",
    "a": "The maxillary sinus is highly significant for posterior dental implants. After tooth loss, the sinus often expands downward (pneumatization) and the alveolar bone resorbs, reducing the available bone height. If the bone is insufficient to support an implant, a <b>sinus lift procedure</b> is required. This involves surgically elevating the sinus membrane and placing a bone graft to increase the bone volume, allowing for successful and stable implant placement without perforating the sinus."
  }
];

// ----------- State -----------
const state = {
  mcq: Array(mcqs.length).fill(null), // null | selectedIndex
  tf: Array(tfs.length).fill(null),   // null | boolean
  saq: Array(saqs.length).fill(false) // self-marked
};

function shuffleIndices(n){
  const arr = Array.from({length:n}, (_,i)=>i);
  for(let i=n-1;i>0;i--){
    const j = Math.floor(Math.random()*(i+1));
    [arr[i],arr[j]] = [arr[j],arr[i]];
  }
  return arr;
}

// ----------- Render MCQs -----------
const mcqGrid = document.getElementById('mcqGrid');
mcqs.forEach((item, idx)=>{
  const map = shuffleIndices(4);
  const visualToOriginal = map;
  const originalToVisual = Array(4);
  map.forEach((orig, v)=>{ originalToVisual[orig] = v; });
  const correctVisualIndex = originalToVisual[item.correct];

  const card = document.createElement('article');
  card.className='card qcard';
  card.dataset.type='mcq';
  card.dataset.index = idx;
  card.dataset.locked = 'false';
  card.innerHTML = `
    <p class="meta">Question ${idx+1} of ${mcqs.length}</p>
    <h3 class="qtitle">${item.q}</h3>
    <div class="opts">
      ${[0,1,2,3].map(v=>`
        <button class="opt-btn" data-v="${v}" aria-label="Answer option ${String.fromCharCode(65+v)}">
          <span class="key">${String.fromCharCode(65+v)}</span>
          <span class="label">${item.opts[ visualToOriginal[v] ]}</span>
        </button>
      `).join('')}
    </div>
    <div class="feedback" hidden></div>
  `;

  const buttons = card.querySelectorAll('.opt-btn');
  const feedback = card.querySelector('.feedback');

  function lock(){
    card.dataset.locked = 'true';
    buttons.forEach(b=>b.setAttribute('disabled',''));
  }

  buttons.forEach(btn=>{
    btn.addEventListener('click', ()=>{
      if(card.dataset.locked === 'true') return; // one attempt
      const v = Number(btn.dataset.v);
      state.mcq[idx] = v;

      // clear classes
      buttons.forEach(b=>b.classList.remove('correct','wrong'));

      // Always mark the correct option (green)
      const correctBtn = buttons[correctVisualIndex];
      correctBtn.classList.add('correct');

      if(v !== correctVisualIndex){
        // Mark chosen wrong option (red)
        btn.classList.add('wrong');
        feedback.hidden=false;
        feedback.innerHTML = `<b>Wrong ✖</b><br>Correct answer: <b>${String.fromCharCode(65+correctVisualIndex)}</b><br>${item.explain}`;
      }else{
        feedback.hidden=false;
        feedback.innerHTML = `<b>Correct ✔</b><br>Answer: <b>${String.fromCharCode(65+correctVisualIndex)}</b><br>${item.explain}`;
      }
      lock();
      recalc();
    });
  });

  mcqGrid.appendChild(card);
});

// ----------- Render True/False -----------
const tfGrid = document.getElementById('tfGrid');
tfs.forEach((item, idx)=>{
  const card = document.createElement('article');
  card.className='card qcard';
  card.dataset.type='tf';
  card.dataset.index = idx;
  card.dataset.locked = 'false';
  card.innerHTML = `
    <p class="meta">Statement ${idx+1} of ${tfs.length}</p>
    <h3 class="qtitle">${item.q}</h3>
    <div class="opts">
      <button class="opt-btn" data-v="true">
        <span class="key">T</span><span class="label">True</span>
      </button>
      <button class="opt-btn" data-v="false">
        <span class="key">F</span><span class="label">False</span>
      </button>
    </div>
    <div class="feedback" hidden></div>
  `;

  const buttons = card.querySelectorAll('.opt-btn');
  const feedback = card.querySelector('.feedback');

  function lock(){
    card.dataset.locked = 'true';
    buttons.forEach(b=>b.setAttribute('disabled',''));
  }

  buttons.forEach(btn=>{
    btn.addEventListener('click', ()=>{
      if(card.dataset.locked === 'true') return; // one attempt
      const val = btn.dataset.v === "true";
      state.tf[idx] = val;

      // clear classes
      buttons.forEach(b=>b.classList.remove('correct','wrong'));

      // Always mark the correct button (green)
      const correctBtn = Array.from(buttons).find(b => (b.dataset.v === (item.answer ? "true" : "false")));
      correctBtn.classList.add('correct');

      const isCorrect = (val === item.answer);
      if(!isCorrect){
        // mark chosen wrong (red)
        btn.classList.add('wrong');
        feedback.hidden=false;
        feedback.innerHTML = `<b>Wrong ✖</b><br>Correct answer: <b>${item.answer ? 'True' : 'False'}</b><br>${item.explain}`;
      }else{
        feedback.hidden=false;
        feedback.innerHTML = `<b>Correct ✔</b><br>Answer: <b>${item.answer ? 'True' : 'False'}</b><br>${item.explain}`;
      }

      lock();
      recalc();
    });
  });

  tfGrid.appendChild(card);
});

// ----------- Render SAQs -----------
const saqGrid = document.getElementById('saqGrid');
saqs.forEach((item, idx)=>{
  const card = document.createElement('article');
  card.className='card qcard';
  card.dataset.type='saq';
  card.dataset.index = idx;
  card.innerHTML = `
  <p class="meta">Question ${idx + 1} of ${saqs.length}</p>
  <h3 class="qtitle">${item.q}</h3>
  <textarea rows="4" placeholder="Type your answer..." style="width:100%;padding:12px;border-radius:12px;background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.14);color:var(--text);font-family:inherit;"></textarea>
  <div class="btnrow" style="margin-top:10px">
    <button class="primary" data-act="reveal">Reveal Answer</button>
    <button class="ghost" data-act="toggle">I was correct</button>
  </div>
  <div class="answer" hidden>${item.a}</div>
`;


  const revealBtn = card.querySelector('[data-act="reveal"]');
  const toggleBtn = card.querySelector('[data-act="toggle"]');
  const answer = card.querySelector('.answer');

  revealBtn.addEventListener('click', ()=>{
    answer.hidden = !answer.hidden;
    revealBtn.textContent = answer.hidden ? "Reveal Answer" : "Hide Answer";
  });

  toggleBtn.addEventListener('click', ()=>{
    const now = !state.saq[idx];
    state.saq[idx] = now;
    toggleBtn.textContent = now ? "✓ Counted as correct" : "I was correct";
    toggleBtn.style.outline = now ? "2px solid rgba(34,197,94,.7)" : "none";
    recalc();
  });

  saqGrid.appendChild(card);
});

// ----------- Score + Reset -----------
function recalc(){
  const mcqScore = state.mcq.reduce((s,v,i)=>{
    if(v===null) return s;
    const card = document.querySelector(`.qcard[data-type="mcq"][data-index="${i}"]`);
    const feedback = card.querySelector('.feedback').textContent;
    return s + (feedback.startsWith("Correct") ? 1 : 0);
  },0);
  const tfScore = state.tf.reduce((s,v,i)=>{
    if(v===null) return s;
    const card = document.querySelector(`.qcard[data-type="tf"][data-index="${i}"]`);
    const feedback = card.querySelector('.feedback').textContent;
    return s + (feedback.startsWith("Correct") ? 1 : 0);
  },0);
  const saqScore = state.saq.filter(Boolean).length;
  const total = mcqScore + tfScore + saqScore;

  const ids = ["sMcq","sTf","sSaq","sTotal","sMcq2","sTf2","sSaq2","sTotal2"];
  ids.forEach(id=>{
    const el = document.getElementById(id);
    if(!el) return;
    if(id.includes('Mcq')) el.textContent = mcqScore;
    if(id.includes('Tf')) el.textContent = tfScore;
    if(id.includes('Saq')) el.textContent = saqScore;
    if(id.includes('Total')) el.textContent = total;
  });
}

document.getElementById('resetAll').addEventListener('click', ()=>{
  if (!confirm("Are you sure you want to reset all your answers? Your scores will be cleared.")) {
    return;
  }
  document.querySelectorAll('.qcard .feedback').forEach(f=>{f.hidden=true; f.textContent=''; f.innerHTML='';});
  document.querySelectorAll('.opt-btn').forEach(b=>{
    b.classList.remove('correct','wrong');
    b.removeAttribute('disabled');
  });
  document.querySelectorAll('.qcard[data-type="mcq"], .qcard[data-type="tf"]').forEach(c=>{c.dataset.locked='false';});
  document.querySelectorAll('.qcard[data-type="saq"] textarea').forEach(t=>t.value="");
  document.querySelectorAll('.qcard[data-type="saq"] .answer').forEach(a=>a.hidden=true);
  document.querySelectorAll('.qcard[data-type="saq"] [data-act="reveal"]').forEach(b=>b.textContent="Reveal Answer");
  document.querySelectorAll('.qcard[data-type="saq"] [data-act="toggle"]').forEach(b=>{b.textContent="I was correct"; b.style.outline="none";});

  state.mcq.fill(null); state.tf.fill(null); state.saq.fill(false);
  recalc();
});

recalc();
</script>
</body>
</html>

<!DOCTYPE html>
<html lang="en" style="direction:ltr;">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<title>Interactive Exam • Glowing Dark Theme</title>
<meta name="color-scheme" content="dark" />
<style>
  :root{
    --bg:#0b0b12;
    --text:#f6f7fb;
    --muted:#a6afc6;
    --card:rgba(255,255,255,0.05);
    --card-border:rgba(255,255,255,0.12);
    --glass:rgba(255,255,255,0.04);
    --glass-border:rgba(255,255,255,0.10);
    --glow-cyan:#06b6d4;
    --glow-cyan-outer:rgba(6,182,212,0.40);
    --glow-purple:#8b5cf6;
    --glow-purple-outer:rgba(139,92,246,0.35);
    --white-haze:rgba(255,255,255,0.08);
    --white-outer:rgba(255,255,255,0.15);
    --radius:16px;
    --gap:1.25rem;
    --pad:1.5rem;
    --ok:#22c55e;  /* green */
    --bad:#ef4444; /* red */
  }

  *{box-sizing:border-box}
  body{margin:0;font:16px/1.65 Inter,ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto;color:var(--text);background:var(--bg);min-height:100dvh;}
  .wrap{max-width:1100px;margin:0 auto;padding:24px;}

  .titlebar{
    position: static;z-index:10;
    backdrop-filter:saturate(140%) blur(8px);
    background:linear-gradient(180deg,rgba(11,11,18,0.75),rgba(11,11,18,0.35));
    border-bottom:1px solid var(--glass-border);
  }
  .titlebar .inner{max-width:1100px;margin:0 auto;padding:16px 24px;display:grid;gap:8px;align-items:center;}
  .grad-text{
    font-weight:800;
    letter-spacing:.3px;
    background:linear-gradient(90deg,var(--glow-cyan),var(--glow-purple));
    -webkit-background-clip:text;background-clip:text;color:transparent;
    text-shadow:0 0 10px var(--glow-cyan-outer), 0 0 14px var(--glow-purple-outer);
  }
  h1.grad-text{font-size:clamp(1.6rem,2vw+1rem,2.6rem);margin:0;text-align:center;}
  .subtitle{margin:0;text-align:center;color:var(--muted);font-size:0.95rem}

  .section-h{
    margin:28px 0 14px;
    padding:12px 16px;
    border-radius:var(--radius);
    background:var(--glass);
    border:1px solid var(--glass-border);
    box-shadow: 0 2px 10px var(--white-haze), 0 0 18px rgba(255,255,255,0.06), 0 0 30px var(--white-outer);
    text-align:center;
    font-weight:750;
    font-size:1.15rem;
  }
  .section-h .grad-text{font-size:1.3rem;}

  .grid{display:grid;gap:var(--gap)}
  @media (min-width:800px){
    .grid.mcq{grid-template-columns:repeat(2,minmax(0,1fr));}
    .grid.tf {grid-template-columns:repeat(3,minmax(0,1fr));}
  }

  /* Cards (no accent on the card itself) */
  .card{
    background:var(--card);
    border:1px solid var(--card-border);
    border-radius:var(--radius);
    padding:var(--pad);
    box-shadow: 0 2px 8px var(--white-haze), 0 0 0 1px rgba(255,255,255,0.02), 0 0 24px rgba(255,255,255,0.06);
    position:relative;
  }

  .qtitle{font-weight:650;margin:0 0 12px}
  .meta{color:var(--muted);font-size:0.88rem;margin-bottom:10px}

  .opts{display:grid;gap:10px}
  .opt-btn{
    all:unset;cursor:pointer;display:flex;gap:10px;align-items:center;
    padding:12px 14px;border-radius:12px;
    background:rgba(255,255,255,0.03);
    border:1px solid rgba(255,255,255,0.10);
    transition:transform .06s ease, background .15s ease, border-color .15s ease;
  }
  .opt-btn .key{width:28px;height:28px;border-radius:9px;display:grid;place-items:center;font-weight:700;
    background:linear-gradient(90deg,var(--glow-cyan),var(--glow-purple));color:#0b0b12;
    box-shadow:0 0 10px var(--glow-cyan-outer),0 0 10px var(--glow-purple-outer) inset;
  }
  .opt-btn:hover{transform:translateY(-1px);border-color:rgba(255,255,255,0.22);}

  /* Accent line ONLY on the chosen/correct answer box, no background highlight */
  .opt-btn.correct{
    border-left:6px solid var(--ok);
    outline:none;
    background:rgba(255,255,255,0.03);
  }
  .opt-btn.wrong{
    border-left:6px solid var(--bad);
    outline:none;
    background:rgba(255,255,255,0.03);
  }
  .opt-btn[disabled]{opacity:.85;cursor:not-allowed;pointer-events:none;}

  .feedback{margin-top:10px;border-radius:12px;padding:10px 12px;border:1px dashed rgba(255,255,255,0.18);background:rgba(255,255,255,0.03);color:var(--muted);}
  .feedback[hidden]{display:none;}
  .feedback b{color:var(--text)}

  .answer{margin-top:10px;padding:12px;border-radius:12px;border:1px solid rgba(255,255,255,0.14);background:rgba(255,255,255,0.04)}
  .answer[hidden]{display:none;}
  .btnrow{display:flex;gap:10px;flex-wrap:wrap}
  .ghost, .primary{
    all:unset;cursor:pointer;border-radius:12px;padding:10px 14px;font-weight:650;border:1px solid rgba(255,255,255,0.18);
    background:rgba(255,255,255,0.03);
  }
  .primary{background:linear-gradient(90deg,var(--glow-cyan),var(--glow-purple));color:#0b0b12;border-color:transparent;}

  .score{
    margin:16px 0;padding:12px 14px;border-radius:14px;
    background:var(--glass);border:1px solid var(--glass-border);box-shadow: 0 2px 10px var(--white-haze), 0 0 18px rgba(255,255,255,0.06), 0 0 30px var(--white-outer);
    display:flex;justify-content:space-between;align-items:center;gap:10px;flex-wrap:wrap;
  }
  .score .part{color:var(--muted);font-weight:600}
  .score b{color:var(--text)}
  .answer table { width: 100%; border-collapse: collapse; margin-top: 10px; }
  .answer th, .answer td { border: 1px solid var(--card-border); padding: 8px; text-align: left; }
  .answer th { background-color: var(--glass); }
</style>
</head>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-57Q3BDNKFW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-57Q3BDNKFW');
</script>
<body>
  <header class="titlebar">
    <div class="inner">
      <h1 class="grad-text">🦷 Dentistry 3rd year</h1>
      <p class="subtitle">Test based on Lecture 25</p>
    </div>
  </header>

  <main class="wrap">

    <h2 class="section-h"><span class="grad-text">اللَّهُمَّ لا سَهْلَ إِلَّا مَا جَعَلْتَهُ سَهْلًا، وَأَنْتَ تَجْعَلُ الحَزْنَ إِذَا شِئْتَ سَهْلًا</span></h2>

    <section class="score" id="scoreTop">
      <div class="part">MCQs: <b><span id="sMcq">0</span>/30</b></div>
      <div class="part">True/False: <b><span id="sTf">0</span>/9</b></div>
      <div class="part">SAQs: <b><span id="sSaq">0</span>/6</b></div>
      <div class="part">Total: <b><span id="sTotal">0</span>/45</b></div>
      <div class="btnrow">
        <button class="ghost" id="resetAll">Reset</button>
      </div>
    </section>

    <h2 class="section-h"><span class="grad-text">MCQs</span></h2>
    <div class="grid mcq" id="mcqGrid"></div>

    <h2 class="section-h"><span class="grad-text">True / False</span></h2>
    <div class="grid tf" id="tfGrid"></div>

    <h2 class="section-h"><span class="grad-text">Short Answer Questions</span></h2>
    <div class="grid" id="saqGrid"></div>

    <section class="score" id="scoreBottom">
      <div class="part">MCQs: <b><span id="sMcq2">0</span>/30</b></div>
      <div class="part">True/False: <b><span id="sTf2">0</span>/9</b></div>
      <div class="part">SAQs: <b><span id="sSaq2">0</span>/6</b></div>
      <div class="part">Total: <b><span id="sTotal2">0</span>/45</b></div>
    </section>
  </main>

<script>
// ----------- Data -----------
const mcqs = [
  {
    q: "When does the development of the periodontal ligament (PDL) begin?",
    opts: [
      "After tooth eruption is complete",
      "With root formation, prior to tooth eruption",
      "During the bell stage of tooth development",
      "Simultaneously with crown formation"
    ],
    correct: 1,
    explain: "PDL development is initiated with the formation of the root by Hertwig's epithelial root sheath (HERS) before the tooth emerges into the oral cavity."
  },
  {
    q: "What structure is formed by the continuous proliferation of the internal and external enamel epithelium?",
    opts: [
      "Dental papilla",
      "Stellate reticulum",
      "Cervical loop",
      "Dental follicle"
    ],
    correct: 2,
    explain: "The cervical loop is the structure at the cervical aspect of the enamel organ where the inner and outer enamel epithelia meet and proliferate to form HERS."
  },
  {
    q: "Hertwig's epithelial root sheath (HERS) grows apically between which two structures?",
    opts: [
      "Dental papilla and dental follicle",
      "Enamel and dentin",
      "Alveolar bone and gingiva",
      "Cementum and dental pulp"
    ],
    correct: 0,
    explain: "HERS grows down between the dental papilla (which will form pulp and dentin) and the dental follicle (which will form the PDL, cementum, and alveolar bone)."
  },
  {
    q: "Which cells within the developing PDL have the potential to differentiate into osteoblasts, cementoblasts, and fibroblasts?",
    opts: [
      "Epithelial cell rests of Malassez",
      "Odontoblasts",
      "Ameloblasts",
      "Undifferentiated stem cells"
    ],
    correct: 3,
    explain: "The dental follicle contains undifferentiated mesenchymal stem cells that are crucial for forming the various tissues of the periodontium."
  },
  {
    q: "Which are the first principal fiber bundles of the PDL to become discernible?",
    opts: [
      "Oblique fiber group",
      "Apical fiber group",
      "Horizontal fiber group",
      "Alveolar crest fiber bundle group"
    ],
    correct: 3,
    explain: "The alveolar crest fibers are the first to form, appearing just before tooth eruption adjacent to the cementum in the coronal third of the root."
  },
  {
    q: "What is the initial orientation of the alveolar crest fibers as they are forming?",
    opts: [
      "Horizontal",
      "Parallel to the long axis of the tooth",
      "Oblique",
      "Circular"
    ],
    correct: 2,
    explain: "Initially, the developing alveolar crest fibers are aligned in an oblique direction to the long axis of the tooth."
  },
  {
    q: "At what stage are the horizontal group of principal fibers almost completely developed?",
    opts: [
      "Before root formation begins",
      "By the time of first occlusal contact",
      "After the apex of the root is fully formed",
      "During crown calcification"
    ],
    correct: 1,
    explain: "The development of the principal fibers progresses coronally to apically. The horizontal fibers (in the coronal third) are well-developed when the tooth first contacts its antagonist."
  },
  {
    q: "Which of the following is NOT considered a primary function of the PDL?",
    opts: [
      "Supportive",
      "Sensory",
      "Hormonal",
      "Nutritive"
    ],
    correct: 2,
    explain: "The PDL's functions are physical/supportive, homeostatic, sensory, eruptive, and nutritive. It does not have a primary hormonal function."
  },
  {
    q: "Which physical function involves protecting vessels and nerves from mechanical forces?",
    opts: [
      "Transmission of occlusal forces",
      "Provision of a soft-tissue 'casing'",
      "Attachment of teeth to bone",
      "Shock absorption"
    ],
    correct: 1,
    explain: "The PDL acts as a soft-tissue casing that cushions and protects the neurovascular structures within it from damage during mastication."
  },
  {
    q: "Under an axial occlusal force, which principal fibers sustain the major part of the force?",
    opts: [
      "Horizontal fibers",
      "Apical fibers",
      "Oblique fibers",
      "Alveolar crest fibers"
    ],
    correct: 2,
    explain: "The oblique fibers are oriented to best resist axial forces, altering their wavy pattern to become taut and transmit the force to the bone."
  },
  {
    q: "When a horizontal or tipping force is applied to a tooth, how does the apical portion of the root move?",
    opts: [
      "In the same direction as the crown",
      "It does not move",
      "In the opposite direction to the coronal portion",
      "In a random, unpredictable direction"
    ],
    correct: 2,
    explain: "The tooth rotates around an axis. When the crown is tipped in one direction, the apex of the root moves in the opposite direction."
  },
  {
    q: "What is the core concept of the 'tensional theory' of tooth support?",
    opts: [
      "Fluid movements control tooth displacement.",
      "Principal fibers are the major factor in supporting the tooth.",
      "The bony socket elasticity is irrelevant.",
      "Only the apical fibers resist occlusal forces."
    ],
    correct: 1,
    explain: "The tensional theory posits that the principal fibers of the PDL play the primary role by unfolding and transmitting forces to the alveolar bone."
  },
  {
    q: "According to the 'viscoelastic system theory', what is the initial event when forces are transmitted to a tooth?",
    opts: [
      "Principal fibers immediately tighten.",
      "Extracellular fluid passes from the PDL into bone marrow spaces.",
      "Cementum gets compressed.",
      "Blood vessels in the PDL constrict."
    ],
    correct: 1,
    explain: "This theory suggests that the initial shock absorption is handled by the movement of fluid out of the PDL space, with the fibers playing a secondary role."
  },
  {
    q: "What is the primary function of the sensory nerve fibers in the PDL?",
    opts: [
      "Regulating blood flow",
      "Controlling cell differentiation",
      "Transmitting tactile, pressure, and pain sensations",
      "Initiating bone resorption"
    ],
    correct: 2,
    explain: "The PDL is richly innervated with sensory fibers that provide proprioceptive feedback (touch, pressure) and nociception (pain) via the trigeminal nerve."
  },
  {
    q: "Compared to other ligaments and tendons, the PDL is considered to be:",
    opts: [
      "Poorly vascularized",
      "Highly vascularized",
      "Avascular",
      "Equally vascularized"
    ],
    correct: 1,
    explain: "The PDL has a rich blood supply to meet the high metabolic demands of its cells and to support its nutritive and remodeling functions."
  },
  {
    q: "Which of these is a described age-related change in the periodontal ligament?",
    opts: [
      "Increased numbers of fibroblasts",
      "Increased organic matrix production",
      "Decreased amounts of elastic fiber",
      "Decreased epithelial cell rests"
    ],
    correct: 3,
    explain: "With age, the PDL tends to show a decrease in fibroblasts, matrix production, and epithelial cell rests, but an increase in elastic fibers."
  },
  {
    q: "What is the consequence of decreased cell proliferation in the PDL with age?",
    opts: [
      "An enhanced repair potential",
      "A wider PDL space",
      "An impairment of repair potential",
      "Increased resistance to occlusal forces"
    ],
    correct: 2,
    explain: "Reduced cell proliferation capacity with age suggests that the PDL's ability to repair and remodel itself in response to injury or stress is diminished."
  },
  {
    q: "The constant breakdown and replacement of old cells and fibers in the PDL is known as:",
    opts: [
      "Homeostasis",
      "Apoptosis",
      "Remodelling",
      "Calcification"
    ],
    correct: 2,
    explain: "The PDL is a dynamic tissue that is constantly undergoing remodeling to adapt to functional demands."
  },
  {
    q: "Regulatory molecules secreted by PDL cells are essential for which process?",
    opts: [
      "Tooth color determination",
      "Saliva production",
      "Enamel formation",
      "Tissue remodeling and homeostasis"
    ],
    correct: 3,
    explain: "PDL cells actively participate in maintaining the ligament's structure and width by secreting molecules that regulate the activity of bone, cementum, and fiber-forming cells."
  },
  {
    q: "Which cells are NOT formed from the undifferentiated mesenchymal cells of the dental follicle?",
    opts: [
      "Cementoblasts",
      "Osteoblasts",
      "Fibroblasts",
      "Ameloblasts"
    ],
    correct: 3,
    explain: "Ameloblasts, which form enamel, are of ectodermal origin from the inner enamel epithelium, not mesenchymal origin like the cells of the dental follicle."
  },
  {
    q: "The definitive architecture of the PDL is established with the formation of which fiber group?",
    opts: [
      "Horizontal fiber group",
      "Alveolar crest fiber group",
      "Oblique fiber group",
      "Apical fiber group"
    ],
    correct: 3,
    explain: "The maturation of the PDL progresses apically, and the formation of the apical fiber group marks the establishment of the complete, definitive PDL structure."
  },
  {
    q: "In areas of tension due to tipping forces, how do the principal fibers appear?",
    opts: [
      "Wavy and relaxed",
      "Compressed",
      "Taut",
      "Broken down"
    ],
    correct: 2,
    explain: "In tension zones, the fibers are stretched and become taut. In pressure zones, they are compressed."
  },
  {
    q: "The nutritive function of the PDL supplies nutrients to all the following tissues EXCEPT:",
    opts: [
      "Cementum",
      "Bone",
      "Gingiva",
      "Enamel"
    ],
    correct: 3,
    explain: "Enamel is acellular and avascular; it does not receive nutrients from the PDL. The PDL nourishes the cellular cementum, the alveolar bone, and the gingiva."
  },
  {
    q: "What is the role of fibroblasts in the PDL?",
    opts: [
      "Resorbing bone",
      "Forming collagen fibers",
      "Transmitting sensory signals",
      "Forming blood vessels"
    ],
    correct: 1,
    explain: "Fibroblasts are the primary cells of the PDL responsible for synthesizing and breaking down collagen fibers, thus maintaining the ligament's integrity."
  },
  {
    q: "What does 'homeostasis' in the context of the PDL refer to?",
    opts: [
      "The ability to transmit pain",
      "The process of tooth eruption",
      "Maintaining its width at a constant dimension",
      "The initial formation of collagen fibers"
    ],
    correct: 2,
    explain: "A key homeostatic function of the PDL is its ability to regulate bone and cementum formation and resorption to maintain its own width throughout life."
  },
  {
    q: "When teeth first come into occlusion, the fiber bundles of the PDL are:",
    opts: [
      "Thin and poorly oriented",
      "Thick and well-organized",
      "Completely absent",
      "Only present at the apex"
    ],
    correct: 1,
    explain: "Initially, the developing fiber bundles are thin and not well-oriented. They become well-organized in terms of thickness and orientation only after the teeth are in function."
  },
  {
    q: "Which theory of tooth support better explains the initial tooth movement under load?",
    opts: [
      "Tensional theory",
      "Viscoelastic system theory",
      "Fiber bundle theory",
      "Occlusal force theory"
    ],
    correct: 1,
    explain: "The viscoelastic system theory, which emphasizes fluid movement, is considered to better explain the immediate displacement of the tooth when a force is first applied."
  },
  {
    q: "The formative and remodeling function of the PDL is LEAST active during:",
    opts: [
      "Physiologic tooth movement",
      "Orthodontic tooth movement",
      "Repair of injuries",
      "A state of complete ankylosis"
    ],
    correct: 3,
    explain: "Ankylosis is the fusion of the tooth to the bone, meaning the PDL is obliterated. In this state, there is no formative or remodeling function as the ligament no longer exists."
  },
  {
    q: "What is the fate of HERS after root formation?",
    opts: [
      "It transforms into cementoblasts",
      "It completely disintegrates and vanishes",
      "It persists as the epithelial cell rests of Malassez",
      "It forms the junctional epithelium"
    ],
    correct: 2,
    explain: "After guiding root formation, HERS breaks down, but remnants persist within the PDL as clusters of epithelial cells known as the cell rests of Malassez."
  },
  {
    q: "The maintenance of gingival tissues in their proper relationship to the teeth is a function of:",
    opts: [
      "Only the nutritive function",
      "Only the sensory function",
      "The physical function",
      "The homeostatic function"
    ],
    correct: 2,
    explain: "The attachment of the tooth to the bone via the PDL, including the supracrestal fibers, is a key physical function that maintains the position and integrity of the gingival tissues."
  }
];

const tfs = [
  {
    q: "The development of the periodontal ligament is complete before the tooth erupts into the oral cavity.",
    answer: false,
    explain: "PDL development begins before eruption but continues as the tooth erupts and comes into function, with fiber bundles becoming fully organized only after occlusal contact is established."
  },
  {
    q: "The dental follicle is composed of a single, uniform population of mesenchymal cells.",
    answer: false,
    explain: "The dental follicle consists of at least two subpopulations: mesenchymal cells of the dental follicle proper and the perifollicular mesenchyme."
  },
  {
    q: "The oblique fibers are the principal fibers most resistant to horizontal or tipping forces.",
    answer: false,
    explain: "Oblique fibers are best suited to resist axial (vertical) forces. Horizontal and alveolar crest fibers are more effective at resisting horizontal or tipping forces."
  },
  {
    q: "The viscoelastic system theory suggests that PDL fibers play only a secondary role in shock absorption.",
    answer: true,
    explain: "This theory prioritizes the role of fluid movement from the PDL into bone for initial shock absorption, with the fibers tightening afterward."
  },
  {
    q: "The periodontal ligament is an avascular and aneural tissue.",
    answer: false,
    explain: "The PDL is highly vascularized and abundantly supplied with sensory nerve fibers, which are critical for its nutritive and sensory functions."
  },
  {
    q: "During orthodontic tooth movement, cells of the PDL participate in the resorption and formation of bone and cementum.",
    answer: true,
    explain: "The formative and remodeling function of the PDL is essential for the bone resorption (on the pressure side) and bone apposition (on the tension side) that allows teeth to move orthodontically."
  },
  {
    q: "With age, the number of fibroblasts and the rate of collagen synthesis in the PDL increase.",
    answer: false,
    explain: "Age-related changes typically include a decrease in the number of fibroblasts and decreased organic matrix production, leading to an impaired repair potential."
  },
  {
    q: "All developing fiber bundles of the PDL are initially thin and not well oriented.",
    answer: true,
    explain: "The organization of PDL fiber bundles into thick, well-oriented groups only occurs after the tooth has come into functional occlusion."
  },
  {
    q: "The sensory information from the PDL is transmitted via the facial nerve.",
    answer: false,
    explain: "Sensory information (tactile, pressure, pain) from the PDL is transmitted via the trigeminal nerve (Cranial Nerve V)."
  }
];

const saqs = [
  {
    q: "Describe the two main theories that explain the mechanism of tooth support and shock absorption by the PDL.",
    a: "The two main theories are the <strong>Tensional Theory</strong> and the <strong>Viscoelastic System Theory</strong>.<br><br>1. <strong>Tensional Theory:</strong> This theory states that the principal fibers of the PDL are the major factor. When force is applied, these fibers unfold, straighten, and transmit the forces to the alveolar bone, causing it to deform elastically.<br><br>2. <strong>Viscoelastic System Theory:</strong> This theory proposes that tooth displacement is primarily controlled by fluid movements. When force is applied, extracellular fluid is pushed from the PDL into the marrow spaces of the bone, providing the initial shock absorption. The fibers tighten only after the fluid has been displaced."
  },
  {
    q: "List the six primary functions of the periodontal ligament.",
    a: `The six main functions of the PDL are:
      <ol>
        <li><strong>Physical/Supportive:</strong> Attaches the tooth to bone, transmits occlusal forces, absorbs shock, and protects vessels and nerves.</li>
        <li><strong>Formative/Remodeling:</strong> Contains cells that form and resorb cementum, bone, and PDL fibers.</li>
        <li><strong>Homeostatic:</strong> Maintains the width and integrity of the PDL space.</li>
        <li><strong>Sensory:</strong> Provides tactile, pressure, and pain sensation through abundant nerve supply.</li>
        <li><strong>Eruptive:</strong> Plays a role in accommodating tooth eruption and movement.</li>
        <li><strong>Nutritive:</strong> Supplies nutrients to the cementum, alveolar bone, and gingiva through its rich blood supply.</li>
      </ol>`
  },
  {
    q: "Compare the PDL's response to axial forces versus tipping (horizontal) forces.",
    a: `<table>
        <thead>
          <tr>
            <th>Feature</th>
            <th>Response to Axial Force</th>
            <th>Response to Tipping Force</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>1. Primary Fibers Involved</td>
            <td>The <strong>oblique fibers</strong> bear the majority of the force, transmitting it to the bone.</td>
            <td>Fibers on one side (tension side) become <strong>taut</strong>, while fibers on the opposite side (pressure side) are <strong>compressed</strong>.</td>
          </tr>
          <tr>
            <td>2. Tooth Movement</td>
            <td>The root tends to be displaced apically into the alveolus.</td>
            <td>The tooth rotates about an axis, with the crown and apex moving in <strong>opposite directions</strong>.</td>
          </tr>
          <tr>
            <td>3. Bone Response</td>
            <td>Generally uniform tension on the alveolar bone socket.</td>
            <td>Creates distinct areas of tension and pressure on the bony socket wall, leading to remodeling if the force is sustained.</td>
          </tr>
        </tbody>
      </table>`
  },
  {
    q: "A 14-year-old patient is undergoing orthodontic treatment to correct crowded lower incisors. Describe the cellular activities occurring within the periodontal ligament that allow the teeth to move through the bone.",
    a: "During orthodontic treatment, sustained pressure and tension are applied to the teeth. On the <strong>pressure side</strong> (the direction of tooth movement), the compressed PDL signals cells like osteoclasts to resorb the alveolar bone. On the <strong>tension side</strong>, the stretched PDL fibers stimulate cells like osteoblasts to deposit new bone (apposition). Simultaneously, the fibroblasts within the PDL are actively remodeling the collagen fiber network to adapt to the new tooth position. This coordinated process of resorption and apposition allows the tooth to move through the jaw without damaging the periodontium."
  },
  {
    q: "What are the main age-related changes that occur in the periodontal ligament, and what is their clinical significance?",
    a: `The main age-related changes in the PDL include:
      <ol>
        <li>Decreased number of fibroblasts and reduced cell proliferation.</li>
        <li>Decreased production of organic matrix (collagen).</li>
        <li>Decreased number of epithelial cell rests of Malassez.</li>
        <li>Increased amount of elastic fiber.</li>
      </ol>
      The clinical significance of these changes is primarily an <strong>impaired repair potential</strong>. The PDL in an older individual may respond more slowly to injuries, occlusal trauma, or orthodontic forces, and its capacity for regeneration may be diminished.`
  },
  {
    q: "Explain the role of Hertwig's Epithelial Root Sheath (HERS) in the development of the periodontal ligament.",
    a: "Hertwig's Epithelial Root Sheath (HERS) plays a crucial, indirect role. It is an epithelial structure that grows apically from the cervical loop, shaping the root of the tooth. As HERS grows, it induces adjacent cells in the dental papilla to differentiate into odontoblasts and form root dentin. After dentin is formed, HERS begins to break down. This fragmentation allows cells from the dental follicle to come into contact with the newly formed root dentin. This contact is the signal for these dental follicle cells to differentiate into cementoblasts, which then lay down cementum on the root surface. Other cells in the dental follicle differentiate into fibroblasts to form the PDL fibers, which embed into the cementum and the alveolar bone."
  }
];

// ----------- State -----------
const state = {
  mcq: Array(mcqs.length).fill(null), // null | selectedIndex
  tf: Array(tfs.length).fill(null),   // null | boolean
  saq: Array(saqs.length).fill(false) // self-marked
};

function shuffleIndices(n){
  const arr = Array.from({length:n}, (_,i)=>i);
  for(let i=n-1;i>0;i--){
    const j = Math.floor(Math.random()*(i+1));
    [arr[i],arr[j]] = [arr[j],arr[i]];
  }
  return arr;
}

// ----------- Render MCQs -----------
const mcqGrid = document.getElementById('mcqGrid');
mcqs.forEach((item, idx)=>{
  const map = shuffleIndices(4);
  const visualToOriginal = map;
  const originalToVisual = Array(4);
  map.forEach((orig, v)=>{ originalToVisual[orig] = v; });
  const correctVisualIndex = originalToVisual[item.correct];

  const card = document.createElement('article');
  card.className='card qcard';
  card.dataset.type='mcq';
  card.dataset.index = idx;
  card.dataset.locked = 'false';
  card.innerHTML = `
    <p class="meta">Question ${idx+1} of ${mcqs.length}</p>
    <h3 class="qtitle">${item.q}</h3>
    <div class="opts">
      ${[0,1,2,3].map(v=>`
        <button class="opt-btn" data-v="${v}" aria-label="Answer option ${String.fromCharCode(65+v)}">
          <span class="key">${String.fromCharCode(65+v)}</span>
          <span class="label">${item.opts[ visualToOriginal[v] ]}</span>
        </button>
      `).join('')}
    </div>
    <div class="feedback" hidden></div>
  `;

  const buttons = card.querySelectorAll('.opt-btn');
  const feedback = card.querySelector('.feedback');

  function lock(){
    card.dataset.locked = 'true';
    buttons.forEach(b=>b.setAttribute('disabled',''));
  }

  buttons.forEach(btn=>{
    btn.addEventListener('click', ()=>{
      if(card.dataset.locked === 'true') return; // one attempt
      const v = Number(btn.dataset.v);
      state.mcq[idx] = v;

      // clear classes
      buttons.forEach(b=>b.classList.remove('correct','wrong'));

      // Always mark the correct option (green)
      const correctBtn = buttons[correctVisualIndex];
      correctBtn.classList.add('correct');

      if(v !== correctVisualIndex){
        // Mark chosen wrong option (red)
        btn.classList.add('wrong');
        feedback.hidden=false;
        feedback.innerHTML = `<b>Wrong ✖</b><br>Correct answer: <b>${String.fromCharCode(65+correctVisualIndex)}</b><br>${item.explain}`;
      }else{
        feedback.hidden=false;
        feedback.innerHTML = `<b>Correct ✔</b><br>Answer: <b>${String.fromCharCode(65+correctVisualIndex)}</b><br>${item.explain}`;
      }
      lock();
      recalc();
    });
  });

  mcqGrid.appendChild(card);
});

// ----------- Render True/False -----------
const tfGrid = document.getElementById('tfGrid');
tfs.forEach((item, idx)=>{
  const card = document.createElement('article');
  card.className='card qcard';
  card.dataset.type='tf';
  card.dataset.index = idx;
  card.dataset.locked = 'false';
  card.innerHTML = `
    <p class="meta">Statement ${idx+1} of ${tfs.length}</p>
    <h3 class="qtitle">${item.q}</h3>
    <div class="opts">
      <button class="opt-btn" data-v="true">
        <span class="key">T</span><span class="label">True</span>
      </button>
      <button class="opt-btn" data-v="false">
        <span class="key">F</span><span class="label">False</span>
      </button>
    </div>
    <div class="feedback" hidden></div>
  `;

  const buttons = card.querySelectorAll('.opt-btn');
  const feedback = card.querySelector('.feedback');

  function lock(){
    card.dataset.locked = 'true';
    buttons.forEach(b=>b.setAttribute('disabled',''));
  }

  buttons.forEach(btn=>{
    btn.addEventListener('click', ()=>{
      if(card.dataset.locked === 'true') return; // one attempt
      const val = btn.dataset.v === "true";
      state.tf[idx] = val;

      // clear classes
      buttons.forEach(b=>b.classList.remove('correct','wrong'));

      // Always mark the correct button (green)
      const correctBtn = Array.from(buttons).find(b => (b.dataset.v === (item.answer ? "true" : "false")));
      correctBtn.classList.add('correct');

      const isCorrect = (val === item.answer);
      if(!isCorrect){
        // mark chosen wrong (red)
        btn.classList.add('wrong');
        feedback.hidden=false;
        feedback.innerHTML = `<b>Wrong ✖</b><br>Correct answer: <b>${item.answer ? 'True' : 'False'}</b><br>${item.explain}`;
      }else{
        feedback.hidden=false;
        feedback.innerHTML = `<b>Correct ✔</b><br>Answer: <b>${item.answer ? 'True' : 'False'}</b><br>${item.explain}`;
      }

      lock();
      recalc();
    });
  });

  tfGrid.appendChild(card);
});

// ----------- Render SAQs -----------
const saqGrid = document.getElementById('saqGrid');
saqs.forEach((item, idx)=>{
  const card = document.createElement('article');
  card.className='card qcard';
  card.dataset.type='saq';
  card.dataset.index = idx;
  card.innerHTML = `
  <p class="meta">Question ${idx + 1} of ${saqs.length}</p>
  <h3 class="qtitle">${item.q}</h3>
  <textarea rows="4" placeholder="Type your answer..." style="width:100%;padding:12px;border-radius:12px;background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.14);color:var(--text);font-family:inherit;"></textarea>
  <div class="btnrow" style="margin-top:10px">
    <button class="primary" data-act="reveal">Reveal Answer</button>
    <button class="ghost" data-act="toggle">I was correct</button>
  </div>
  <div class="answer" hidden>${item.a}</div>
`;


  const revealBtn = card.querySelector('[data-act="reveal"]');
  const toggleBtn = card.querySelector('[data-act="toggle"]');
  const answer = card.querySelector('.answer');

  revealBtn.addEventListener('click', ()=>{
    answer.hidden = !answer.hidden;
    revealBtn.textContent = answer.hidden ? "Reveal Answer" : "Hide Answer";
  });

  toggleBtn.addEventListener('click', ()=>{
    const now = !state.saq[idx];
    state.saq[idx] = now;
    toggleBtn.textContent = now ? "✓ Counted as correct" : "I was correct";
    toggleBtn.style.outline = now ? "2px solid rgba(34,197,94,.7)" : "none";
    recalc();
  });

  saqGrid.appendChild(card);
});

// ----------- Score + Reset -----------
function recalc(){
  const mcqScore = state.mcq.reduce((s,v,i)=>{
    if(v===null) return s;
    const card = document.querySelector(`.qcard[data-type="mcq"][data-index="${i}"]`);
    const feedback = card.querySelector('.feedback').textContent;
    return s + (feedback.startsWith("Correct") ? 1 : 0);
  },0);
  const tfScore = state.tf.reduce((s,v,i)=>{
    if(v===null) return s;
    const card = document.querySelector(`.qcard[data-type="tf"][data-index="${i}"]`);
    const feedback = card.querySelector('.feedback').textContent;
    return s + (feedback.startsWith("Correct") ? 1 : 0);
  },0);
  const saqScore = state.saq.filter(Boolean).length;
  const total = mcqScore + tfScore + saqScore;

  const ids = ["sMcq","sTf","sSaq","sTotal","sMcq2","sTf2","sSaq2","sTotal2"];
  ids.forEach(id=>{
    const el = document.getElementById(id);
    if(!el) return;
    if(id.includes('Mcq')) el.textContent = mcqScore;
    if(id.includes('Tf')) el.textContent = tfScore;
    if(id.includes('Saq')) el.textContent = saqScore;
    if(id.includes('Total')) el.textContent = total;
  });
}

document.getElementById('resetAll').addEventListener('click', ()=>{
  document.querySelectorAll('.qcard .feedback').forEach(f=>{f.hidden=true; f.textContent=''; f.innerHTML='';});
  document.querySelectorAll('.opt-btn').forEach(b=>{
    b.classList.remove('correct','wrong');
    b.removeAttribute('disabled');
  });
  document.querySelectorAll('.qcard[data-type="mcq"], .qcard[data-type="tf"]').forEach(c=>{c.dataset.locked='false';});
  document.querySelectorAll('.qcard[data-type="saq"] textarea').forEach(t=>t.value="");
  document.querySelectorAll('.qcard[data-type="saq"] .answer').forEach(a=>a.hidden=true);
  document.querySelectorAll('.qcard[data-type="saq"] [data-act="reveal"]').forEach(b=>b.textContent="Reveal Answer");
  document.querySelectorAll('.qcard[data-type="saq"] [data-act="toggle"]').forEach(b=>{b.textContent="I was correct"; b.style.outline="none";});

  state.mcq.fill(null); state.tf.fill(null); state.saq.fill(false);
  recalc();
});

recalc();
</script>
</body>
</html>
